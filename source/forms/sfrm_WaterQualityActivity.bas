Version =20
VersionRequired =20
Begin Form
    AutoResize = NotDefault
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =17370
    DatasheetFontHeight =11
    ItemSuffix =44
    Left =1230
    Top =1770
    Right =17070
    Bottom =10755
    DatasheetGridlinesColor =15921906
    RecSrcDt = Begin
        0x19205bcaca15e540
    End
    RecordSource ="data_WaterQualityActivity"
    BeforeUpdate ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    ThemeName ="1_SVTestTheme"
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin Chart
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin EmptyCell
            Height =240
            GridlineColor =12632256
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =0
            BackColor =15921906
            Name ="FormHeader"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
        End
        Begin Section
            CanGrow = NotDefault
            Height =12300
            BackColor =15921906
            Name ="Detail"
            AlternateBackColor =15527148
            Begin
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =4496
                    Top =8160
                    Width =11105
                    Height =966
                    FontSize =10
                    TabIndex =14
                    BorderColor =14211288
                    Name ="txtDataProcessingLevelNote"
                    ControlSource ="DataProcessingLevelNote"
                    GridlineColor =10921638

                    LayoutCachedLeft =4496
                    LayoutCachedTop =8160
                    LayoutCachedWidth =15601
                    LayoutCachedHeight =9126
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =3900
                            Top =8164
                            Width =540
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLNote"
                            Caption ="Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =3900
                            LayoutCachedTop =8164
                            LayoutCachedWidth =4440
                            LayoutCachedHeight =8402
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1440
                    Left =1740
                    Top =8340
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =13
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="cboDataProcessingLevelID"
                    ControlSource ="DataProcessingLevelID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_DataProcessingLevel.ID, lookup_DataProcessingLevel.Code, lookup_Da"
                        "taProcessingLevel.Label FROM lookup_DataProcessingLevel; "
                    ColumnWidths ="0;0;1440"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =1740
                    LayoutCachedTop =8340
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =8578
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =480
                            Top =8340
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPL"
                            Caption ="*DPL"
                            GridlineColor =10921638
                            LayoutCachedLeft =480
                            LayoutCachedTop =8340
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =8578
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1740
                    Top =8640
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =15
                    BackColor =15921906
                    BorderColor =10921638
                    Name ="txtDataProcessingLevelDate"
                    ControlSource ="DataProcessingLevelDate"
                    Format ="Short Date"
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =1740
                    LayoutCachedTop =8640
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =8878
                    BackThemeColorIndex =-1
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =480
                            Top =8640
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLDate"
                            Caption ="*DPL Date"
                            GridlineColor =10921638
                            LayoutCachedLeft =480
                            LayoutCachedTop =8640
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =8878
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =0
                    OverlapFlags =255
                    Left =300
                    Top =8040
                    Width =15420
                    Height =1200
                    BorderColor =2500134
                    Name ="Box207"
                    GridlineColor =10921638
                    LayoutCachedLeft =300
                    LayoutCachedTop =8040
                    LayoutCachedWidth =15720
                    LayoutCachedHeight =9240
                    BorderThemeColorIndex =0
                    BorderTint =85.0
                    BorderShade =100.0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =247
                    TextAlign =2
                    Left =480
                    Top =7860
                    Width =2340
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="Label203"
                    Caption ="Data Processing Level"
                    GridlineColor =10921638
                    LayoutCachedLeft =480
                    LayoutCachedTop =7860
                    LayoutCachedWidth =2820
                    LayoutCachedHeight =8160
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =223
                    IMESentenceMode =3
                    Left =300
                    Top =7140
                    Width =15420
                    Height =603
                    TabIndex =12
                    BorderColor =14211288
                    ForeColor =4210752
                    Name ="txtNotes"
                    ControlSource ="Notes"
                    GridlineColor =10921638

                    LayoutCachedLeft =300
                    LayoutCachedTop =7140
                    LayoutCachedWidth =15720
                    LayoutCachedHeight =7743
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =300
                            Top =6960
                            Width =2160
                            Height =240
                            FontSize =8
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="lblNotes"
                            Caption ="Water Quality Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =300
                            LayoutCachedTop =6960
                            LayoutCachedWidth =2460
                            LayoutCachedHeight =7200
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =87
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2160
                    Left =300
                    Top =990
                    Width =2520
                    Height =315
                    TabIndex =1
                    BorderColor =14211288
                    ForeColor =4210752
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    ConditionalFormat = Begin
                        0x010000009e000000010000000100000000000000000000001e00000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b007000480049006e007300740072007500 ,
                        0x6d0065006e007400490044005d0029003d00540072007500650000000000
                    End
                    Name ="cbopHInstrumentID"
                    ControlSource ="pHInstrumentID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ref_WaterQualityInstrument.ID, ref_WaterQualityInstrument.Label, ref_Wate"
                        "rQualityInstrument.Summary, ref_WaterQualityInstrument.NPSPropertyTag, ref_Water"
                        "QualityInstrument.IsActive FROM ref_WaterQualityInstrument; "
                    ColumnWidths ="0;2160"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =300
                    LayoutCachedTop =990
                    LayoutCachedWidth =2820
                    LayoutCachedHeight =1305
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded001d0000004900 ,
                        0x73004e0075006c006c0028005b007000480049006e0073007400720075006d00 ,
                        0x65006e007400490044005d0029003d0054007200750065000000000000000000 ,
                        0x00000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =2
                            Left =300
                            Top =780
                            Width =2520
                            Height =210
                            FontSize =8
                            BorderColor =8355711
                            Name ="Label1"
                            Caption ="pH"
                            GridlineColor =10921638
                            LayoutCachedLeft =300
                            LayoutCachedTop =780
                            LayoutCachedWidth =2820
                            LayoutCachedHeight =990
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =300
                    Top =1920
                    Width =2850
                    Height =1860
                    TabIndex =5
                    BorderColor =10921638
                    Name ="sfrmWaterQualitypH"
                    SourceObject ="Form.sfrm_WaterQualitypH"
                    LinkChildFields ="WaterQualityActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =300
                    LayoutCachedTop =1920
                    LayoutCachedWidth =3150
                    LayoutCachedHeight =3780
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =300
                            Top =1560
                            Width =2520
                            Height =300
                            FontWeight =700
                            BackColor =4281912
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="lblpH"
                            Caption ="ph"
                            GridlineColor =10921638
                            LayoutCachedLeft =300
                            LayoutCachedTop =1560
                            LayoutCachedWidth =2820
                            LayoutCachedHeight =1860
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =87
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2160
                    Left =6780
                    Top =990
                    Width =3795
                    Height =315
                    TabIndex =2
                    BorderColor =14211288
                    ForeColor =4210752
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    ConditionalFormat = Begin
                        0x010000009e000000010000000100000000000000000000001e00000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b0044004f0049006e007300740072007500 ,
                        0x6d0065006e007400490044005d0029003d00540072007500650000000000
                    End
                    Name ="cboDOInstrumentID"
                    ControlSource ="DOInstrumentID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ref_WaterQualityInstrument.ID, ref_WaterQualityInstrument.Label, ref_Wate"
                        "rQualityInstrument.Summary, ref_WaterQualityInstrument.NPSPropertyTag, ref_Water"
                        "QualityInstrument.IsActive FROM ref_WaterQualityInstrument; "
                    ColumnWidths ="0;2160"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =6780
                    LayoutCachedTop =990
                    LayoutCachedWidth =10575
                    LayoutCachedHeight =1305
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded001d0000004900 ,
                        0x73004e0075006c006c0028005b0044004f0049006e0073007400720075006d00 ,
                        0x65006e007400490044005d0029003d0054007200750065000000000000000000 ,
                        0x00000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =2
                            Left =6780
                            Top =780
                            Width =3795
                            Height =210
                            FontSize =8
                            BorderColor =8355711
                            Name ="Label11"
                            Caption ="Dissolved Oxygen"
                            GridlineColor =10921638
                            LayoutCachedLeft =6780
                            LayoutCachedTop =780
                            LayoutCachedWidth =10575
                            LayoutCachedHeight =990
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =6780
                    Top =1920
                    Width =4020
                    Height =1860
                    TabIndex =6
                    BorderColor =10921638
                    Name ="sfrmWaterQualityDO"
                    SourceObject ="Form.sfrm_WaterQualityDO"
                    LinkChildFields ="WaterQualityActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =6780
                    LayoutCachedTop =1920
                    LayoutCachedWidth =10800
                    LayoutCachedHeight =3780
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =6780
                            Top =1560
                            Width =3795
                            Height =300
                            FontWeight =700
                            BackColor =4281912
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="lblDO"
                            Caption ="Dissolved Oxygen"
                            GridlineColor =10921638
                            LayoutCachedLeft =6780
                            LayoutCachedTop =1560
                            LayoutCachedWidth =10575
                            LayoutCachedHeight =1860
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =87
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2160
                    Left =11160
                    Top =990
                    Width =2595
                    Height =315
                    TabIndex =3
                    BorderColor =14211288
                    ForeColor =4210752
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    ConditionalFormat = Begin
                        0x01000000a6000000010000000100000000000000000000002200000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b005300700043006f006e00640049006e00 ,
                        0x73007400720075006d0065006e007400490044005d0029003d00540072007500 ,
                        0x650000000000
                    End
                    Name ="cboSpCondInstrumentID"
                    ControlSource ="SpCondInstrumentID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ref_WaterQualityInstrument.ID, ref_WaterQualityInstrument.Label, ref_Wate"
                        "rQualityInstrument.Summary, ref_WaterQualityInstrument.NPSPropertyTag, ref_Water"
                        "QualityInstrument.IsActive FROM ref_WaterQualityInstrument; "
                    ColumnWidths ="0;2160"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =11160
                    LayoutCachedTop =990
                    LayoutCachedWidth =13755
                    LayoutCachedHeight =1305
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded00210000004900 ,
                        0x73004e0075006c006c0028005b005300700043006f006e00640049006e007300 ,
                        0x7400720075006d0065006e007400490044005d0029003d005400720075006500 ,
                        0x000000000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =2
                            Left =11160
                            Top =780
                            Width =2595
                            Height =210
                            FontSize =8
                            BorderColor =8355711
                            Name ="Label15"
                            Caption ="Specific Conductance"
                            GridlineColor =10921638
                            LayoutCachedLeft =11160
                            LayoutCachedTop =780
                            LayoutCachedWidth =13755
                            LayoutCachedHeight =990
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =11160
                    Top =1920
                    Width =2850
                    Height =1860
                    TabIndex =7
                    BorderColor =10921638
                    Name ="sfrmWaterQualitySpCond"
                    SourceObject ="Form.sfrm_WaterQualitySpCond"
                    LinkChildFields ="WaterQualityActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =11160
                    LayoutCachedTop =1920
                    LayoutCachedWidth =14010
                    LayoutCachedHeight =3780
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =11160
                            Top =1560
                            Width =2595
                            Height =300
                            FontWeight =700
                            BackColor =4281912
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="lblSpCond"
                            Caption ="Specific Conductance"
                            GridlineColor =10921638
                            LayoutCachedLeft =11160
                            LayoutCachedTop =1560
                            LayoutCachedWidth =13755
                            LayoutCachedHeight =1860
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =87
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2160
                    Left =3480
                    Top =990
                    Width =2595
                    Height =315
                    TabIndex =4
                    BorderColor =14211288
                    ForeColor =4210752
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    ConditionalFormat = Begin
                        0x01000000b0000000010000000100000000000000000000002700000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b00540065006d0070006500720061007400 ,
                        0x75007200650049006e0073007400720075006d0065006e007400490044005d00 ,
                        0x29003d00540072007500650000000000
                    End
                    Name ="cboTemperatureInstrumentID"
                    ControlSource ="TemperatureInstrumentID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ref_WaterQualityInstrument.ID, ref_WaterQualityInstrument.Label, ref_Wate"
                        "rQualityInstrument.Summary, ref_WaterQualityInstrument.NPSPropertyTag, ref_Water"
                        "QualityInstrument.IsActive FROM ref_WaterQualityInstrument; "
                    ColumnWidths ="0;2160"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =3480
                    LayoutCachedTop =990
                    LayoutCachedWidth =6075
                    LayoutCachedHeight =1305
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded00260000004900 ,
                        0x73004e0075006c006c0028005b00540065006d00700065007200610074007500 ,
                        0x7200650049006e0073007400720075006d0065006e007400490044005d002900 ,
                        0x3d005400720075006500000000000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =2
                            Left =3480
                            Top =780
                            Width =2595
                            Height =210
                            FontSize =8
                            BorderColor =8355711
                            Name ="Label19"
                            Caption ="Temperature"
                            GridlineColor =10921638
                            LayoutCachedLeft =3480
                            LayoutCachedTop =780
                            LayoutCachedWidth =6075
                            LayoutCachedHeight =990
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =3480
                    Top =1920
                    Width =2850
                    Height =1860
                    TabIndex =8
                    BorderColor =10921638
                    Name ="sfrmWaterQualityTemperature"
                    SourceObject ="Form.sfrm_WaterQualityTemperature"
                    LinkChildFields ="WaterQualityActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =3480
                    LayoutCachedTop =1920
                    LayoutCachedWidth =6330
                    LayoutCachedHeight =3780
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =3480
                            Top =1560
                            Width =2595
                            Height =300
                            FontWeight =700
                            BackColor =4281912
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="lblTemperature"
                            Caption ="Temperature"
                            GridlineColor =10921638
                            LayoutCachedLeft =3480
                            LayoutCachedTop =1560
                            LayoutCachedWidth =6075
                            LayoutCachedHeight =1860
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =2160
                    Left =3660
                    Top =120
                    Width =2760
                    Height =315
                    ColumnOrder =0
                    FontSize =12
                    BorderColor =14211288
                    ForeColor =4210752
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"50\""
                    ConditionalFormat = Begin
                        0x01000000c0000000010000000100000000000000000000002e00000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b00630062006f0057006100740065007200 ,
                        0x5100750061006c00690074007900440061007400610043006f006c006c006500 ,
                        0x6300740065006400490044005d0029003d005400720075006500000000000000
                    End
                    Name ="cboWaterQualityDataCollectedID"
                    ControlSource ="WaterQualityDataCollectedID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_WaterQualityDataCollected.ID, lookup_WaterQualityDataCollected.Cod"
                        "e, lookup_WaterQualityDataCollected.Label FROM lookup_WaterQualityDataCollected;"
                        " "
                    ColumnWidths ="0;0;2160"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =3660
                    LayoutCachedTop =120
                    LayoutCachedWidth =6420
                    LayoutCachedHeight =435
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =0
                    ForeTint =75.0
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded002d0000004900 ,
                        0x73004e0075006c006c0028005b00630062006f00570061007400650072005100 ,
                        0x750061006c00690074007900440061007400610043006f006c006c0065006300 ,
                        0x740065006400490044005d0029003d0054007200750065000000000000000000 ,
                        0x00000000000000000000000000
                    End
                    Begin
                        Begin Label
                            FontItalic = NotDefault
                            OverlapFlags =93
                            TextAlign =1
                            Left =120
                            Top =120
                            Width =3480
                            Height =315
                            FontSize =12
                            FontWeight =700
                            BorderColor =8355711
                            Name ="Label32"
                            Caption ="Was water quality data collected?"
                            GridlineColor =10921638
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =3600
                            LayoutCachedHeight =435
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Top =1410
                    Width =15840
                    Name ="lineHeader"
                    GridlineColor =10921638
                    LayoutCachedTop =1410
                    LayoutCachedWidth =15840
                    LayoutCachedHeight =1410
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =300
                    Top =4320
                    Width =5730
                    Height =2400
                    TabIndex =9
                    BorderColor =10921638
                    Name ="sfrmWaterQualitypHCalibration"
                    SourceObject ="Form.sfrm_WaterQualitypHCalibration"
                    GridlineColor =10921638

                    LayoutCachedLeft =300
                    LayoutCachedTop =4320
                    LayoutCachedWidth =6030
                    LayoutCachedHeight =6720
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =6180
                    Top =4320
                    Width =5100
                    Height =2340
                    TabIndex =10
                    BorderColor =10921638
                    Name ="sfrmWaterQualityDOCalibration"
                    SourceObject ="Form.sfrm_WaterQualityDOCalibration"
                    GridlineColor =10921638

                    LayoutCachedLeft =6180
                    LayoutCachedTop =4320
                    LayoutCachedWidth =11280
                    LayoutCachedHeight =6660
                End
                Begin Subform
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =11460
                    Top =4320
                    Width =4500
                    Height =2340
                    TabIndex =11
                    BorderColor =10921638
                    Name ="sfrmWaterQualitySpCondCalibration"
                    SourceObject ="Form.sfrm_WaterQualitySpCondCalibration"
                    GridlineColor =10921638

                    LayoutCachedLeft =11460
                    LayoutCachedTop =4320
                    LayoutCachedWidth =15960
                    LayoutCachedHeight =6660
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =1
                    Left =120
                    Top =420
                    Width =2100
                    Height =315
                    BorderColor =8355711
                    Name ="Label31"
                    Caption ="*Instruments used:"
                    GridlineColor =10921638
                    LayoutCachedLeft =120
                    LayoutCachedTop =420
                    LayoutCachedWidth =2220
                    LayoutCachedHeight =735
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin CommandButton
                    OverlapFlags =127
                    Left =3840
                    Top =6780
                    Width =1920
                    Height =260
                    FontSize =9
                    TabIndex =16
                    Name ="cmdpHCal"
                    Caption ="New pH Calibration"
                    OnClick ="[Event Procedure]"
                    Tag ="NoLock"
                    LeftPadding =45
                    TopPadding =45
                    RightPadding =150
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =3840
                    LayoutCachedTop =6780
                    LayoutCachedWidth =5760
                    LayoutCachedHeight =7040
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =14211288
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =9211020
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =14277081
                    HoverThemeColorIndex =1
                    HoverTint =100.0
                    HoverShade =85.0
                    PressedColor =14277081
                    PressedThemeColorIndex =1
                    PressedShade =85.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    Shadow =1
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =127
                    Left =8820
                    Top =6780
                    Width =1920
                    Height =260
                    FontSize =9
                    TabIndex =17
                    Name ="cmdDOCal"
                    Caption ="New DO Calibration"
                    OnClick ="[Event Procedure]"
                    Tag ="NoLock"
                    LeftPadding =45
                    TopPadding =45
                    RightPadding =150
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =8820
                    LayoutCachedTop =6780
                    LayoutCachedWidth =10740
                    LayoutCachedHeight =7040
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =14211288
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =9211020
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =14277081
                    HoverThemeColorIndex =1
                    HoverTint =100.0
                    HoverShade =85.0
                    PressedColor =14277081
                    PressedThemeColorIndex =1
                    PressedShade =85.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    Shadow =1
                    Overlaps =1
                End
                Begin CommandButton
                    OverlapFlags =127
                    Left =13200
                    Top =6780
                    Width =2160
                    Height =260
                    FontSize =9
                    TabIndex =18
                    Name ="cmdSpCondCal"
                    Caption ="New SpCond Calibration"
                    OnClick ="[Event Procedure]"
                    Tag ="NoLock"
                    LeftPadding =45
                    TopPadding =45
                    RightPadding =150
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =13200
                    LayoutCachedTop =6780
                    LayoutCachedWidth =15360
                    LayoutCachedHeight =7040
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =14211288
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =9211020
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =14277081
                    HoverThemeColorIndex =1
                    HoverTint =100.0
                    HoverShade =85.0
                    PressedColor =14277081
                    PressedThemeColorIndex =1
                    PressedShade =85.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    Shadow =1
                    Overlaps =1
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =3180
                    Top =6780
                    Width =1920
                    Height =260
                    FontSize =9
                    TabIndex =19
                    Name ="cmdSavepHCal"
                    Caption ="Save pH Calibration"
                    OnClick ="[Event Procedure]"
                    Tag ="NoLock"
                    LeftPadding =45
                    TopPadding =45
                    RightPadding =150
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =3180
                    LayoutCachedTop =6780
                    LayoutCachedWidth =5100
                    LayoutCachedHeight =7040
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =14211288
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =9211020
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =14277081
                    HoverThemeColorIndex =1
                    HoverTint =100.0
                    HoverShade =85.0
                    PressedColor =14277081
                    PressedThemeColorIndex =1
                    PressedShade =85.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    Shadow =1
                    Overlaps =1
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =8520
                    Top =6780
                    Width =1920
                    Height =260
                    FontSize =9
                    TabIndex =20
                    Name ="cmdSaveDOCal"
                    Caption ="Save DO Calibration"
                    OnClick ="[Event Procedure]"
                    Tag ="NoLock"
                    LeftPadding =45
                    TopPadding =45
                    RightPadding =150
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =8520
                    LayoutCachedTop =6780
                    LayoutCachedWidth =10440
                    LayoutCachedHeight =7040
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =14211288
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =9211020
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =14277081
                    HoverThemeColorIndex =1
                    HoverTint =100.0
                    HoverShade =85.0
                    PressedColor =14277081
                    PressedThemeColorIndex =1
                    PressedShade =85.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    Shadow =1
                    Overlaps =1
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =12840
                    Top =6780
                    Width =2160
                    Height =260
                    FontSize =9
                    TabIndex =21
                    Name ="cmdSaveSpCondCal"
                    Caption ="Save SpCond Calibration"
                    OnClick ="[Event Procedure]"
                    Tag ="NoLock"
                    LeftPadding =45
                    TopPadding =45
                    RightPadding =150
                    BottomPadding =150
                    GridlineColor =10921638

                    LayoutCachedLeft =12840
                    LayoutCachedTop =6780
                    LayoutCachedWidth =15000
                    LayoutCachedHeight =7040
                    ForeTint =100.0
                    Shape =0
                    Gradient =0
                    BackColor =14211288
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =9211020
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ThemeFontIndex =-1
                    HoverColor =14277081
                    HoverThemeColorIndex =1
                    HoverTint =100.0
                    HoverShade =85.0
                    PressedColor =14277081
                    PressedThemeColorIndex =1
                    PressedShade =85.0
                    HoverForeColor =0
                    HoverForeTint =100.0
                    PressedForeColor =0
                    PressedForeTint =100.0
                    Shadow =1
                    Overlaps =1
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =285
                    Top =3960
                    Width =5745
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblpHCalibration"
                    Caption ="pH Calibration"
                    GridlineColor =10921638
                    LayoutCachedLeft =285
                    LayoutCachedTop =3960
                    LayoutCachedWidth =6030
                    LayoutCachedHeight =4260
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =240
                    Top =9600
                    Width =6120
                    Height =1860
                    TabIndex =22
                    BorderColor =10921638
                    Name ="sfrmWaterQualityEnterpHCalibration"
                    SourceObject ="Form.sfrm_WaterQualityEnterpHCalibration"
                    GridlineColor =10921638

                    LayoutCachedLeft =240
                    LayoutCachedTop =9600
                    LayoutCachedWidth =6360
                    LayoutCachedHeight =11460
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =6660
                    Top =9540
                    Width =5070
                    Height =1980
                    TabIndex =23
                    BorderColor =10921638
                    Name ="sfrmWaterQualityEnterDOCalibration"
                    SourceObject ="Form.sfrm_WaterQualityEnterDOCalibration"
                    GridlineColor =10921638

                    LayoutCachedLeft =6660
                    LayoutCachedTop =9540
                    LayoutCachedWidth =11730
                    LayoutCachedHeight =11520
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =11940
                    Top =9720
                    Width =5190
                    Height =1620
                    TabIndex =24
                    BorderColor =10921638
                    Name ="sfrmWaterQualityEnterSpCondCalibration"
                    SourceObject ="Form.sfrm_WaterQualityEnterSpCondCalibration"
                    GridlineColor =10921638

                    LayoutCachedLeft =11940
                    LayoutCachedTop =9720
                    LayoutCachedWidth =17130
                    LayoutCachedHeight =11340
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =6180
                    Top =3960
                    Width =5100
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblDOCalibration"
                    Caption ="Dissolved Oxygen Calibration"
                    GridlineColor =10921638
                    LayoutCachedLeft =6180
                    LayoutCachedTop =3960
                    LayoutCachedWidth =11280
                    LayoutCachedHeight =4260
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =11460
                    Top =3960
                    Width =4200
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblSpCondCalibration"
                    Caption ="Specific Conductance Calibration"
                    GridlineColor =10921638
                    LayoutCachedLeft =11460
                    LayoutCachedTop =3960
                    LayoutCachedWidth =15660
                    LayoutCachedHeight =4260
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
            End
        End
        Begin FormFooter
            CanGrow = NotDefault
            Height =0
            BackColor =4281912
            Name ="FormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const mstrcFormName As String = "sfrm_WaterQualityActivity"

Public Function DataQualityOK() As Boolean

Dim dataCollected As String
Dim pHCount As Integer
Dim tempCount As Integer
Dim DOCount As Integer
Dim SpCondCount As Integer
Dim instrumentNotNull As Boolean

If Me.NewRecord Then
    DataQualityOK = True
    GoTo Exit_Procedure
End If

dataCollected = LookupCodeFromID("lookup_WaterQualityDataCollected", Me.cboWaterQualityDataCollectedID)
pHCount = Me.sfrmWaterQualitypH.Form.RowCount()
tempCount = Me.sfrmWaterQualityTemperature.Form.RowCount()
DOCount = Me.sfrmWaterQualityDO.Form.RowCount()
SpCondCount = Me.sfrmWaterQualitySpCond.Form.RowCount()

Select Case dataCollected
Case "Y"
    'If data are collected, at least one wq measurement must have data entered and an instrument specified
    If ((pHCount > 0 And Nz(LookupCodeFromID("ref_WaterQualityInstrument", Me.cbopHInstrumentID)) <> "None") Or _
        (tempCount > 0 And Nz(LookupCodeFromID("ref_WaterQualityInstrument", Me.cboTemperatureInstrumentID)) <> "None") Or _
        (DOCount > 0 And Nz(LookupCodeFromID("ref_WaterQualityInstrument", Me.cboDOInstrumentID)) <> "None") Or _
        (SpCondCount > 0 And Nz(LookupCodeFromID("ref_WaterQualityInstrument", Me.cboSpCondInstrumentID)) <> "None")) And _
        RequiredFieldsPopulated Then
        DataQualityOK = True
    Else: DataQualityOK = False
    End If
Case "NIW", "NO", "NU"
    'If data are not collected, then there should be no data entered. Instruments can be specified, because it may still be necessary to record a calibration
    If (pHCount + tempCount + DOCount + SpCondCount) = 0 And RequiredFieldsPopulated Then
        DataQualityOK = True
    Else: DataQualityOK = False
    End If
End Select

Exit_Procedure:
    Exit Function
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Fxn:  DataQualityOK" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Function

Private Function ToggleCalibrationEntry(entryForm As SubForm, browseForm As SubForm, entryButton As CommandButton, saveButton As CommandButton, entry As Boolean)

'Switch to data entry mode
If entry Then
    'Hide browsing subform, set the data entry subform to the same position and dimensions as the browsing subform, and make the data entry subform visible
    browseForm.Visible = False
    With entryForm
        .Top = browseForm.Top
        .Left = browseForm.Left
        .Height = browseForm.Height
        .Width = browseForm.Width
        .Visible = True
        .SetFocus
        .Form.txtCalibrationDate.SetFocus
    End With
    'Hide enter data button, set save button to same position and size as the enter data button, and make the save data button visible
    entryButton.Visible = False
    With saveButton
        .Top = entryButton.Top
        .Left = entryButton.Left
        .Height = entryButton.Height
        .Width = entryButton.Width
        .Visible = True
    End With
'Switch to browse mode
Else
    'Try to save the calibration data that was entered. If successful, toggle back to the browse subform, otherwise do nothing
    If entryForm.Form.SaveRecord Then
        'Requery the browse form so that the most recent data shows up, then make it visible
        With browseForm
            .Visible = True
            .SetFocus
            .Requery
        End With
        'Requery the data entry form so that it will be blank next time, then make it invisible
        With entryForm
            .Requery
            .Visible = False
        End With
        'Hide save button, show new calibration button
        entryButton.Visible = True
        saveButton.Visible = False
    End If
End If
End Function

Private Sub cmdSpCondCal_Click()

ToggleCalibrationEntry Me.sfrmWaterQualityEnterSpCondCalibration, Me.sfrmWaterQualitySpCondCalibration, Me.cmdSpCondCal, Me.cmdSaveSpCondCal, True

End Sub

Private Sub cmdSaveSpCondCal_Click()

ToggleCalibrationEntry Me.sfrmWaterQualityEnterSpCondCalibration, Me.sfrmWaterQualitySpCondCalibration, Me.cmdSpCondCal, Me.cmdSaveSpCondCal, False

End Sub

Private Sub cmdDOCal_Click()

ToggleCalibrationEntry Me.sfrmWaterQualityEnterDOCalibration, Me.sfrmWaterQualityDOCalibration, Me.cmdDOCal, Me.cmdSaveDOCal, True

End Sub

Private Sub cmdSaveDOCal_Click()

ToggleCalibrationEntry Me.sfrmWaterQualityEnterDOCalibration, Me.sfrmWaterQualityDOCalibration, Me.cmdDOCal, Me.cmdSaveDOCal, False

End Sub

Private Sub cmdpHCal_Click()

ToggleCalibrationEntry Me.sfrmWaterQualityEnterpHCalibration, Me.sfrmWaterQualitypHCalibration, Me.cmdpHCal, Me.cmdSavepHCal, True

End Sub

Private Sub cmdSavepHCal_Click()

ToggleCalibrationEntry Me.sfrmWaterQualityEnterpHCalibration, Me.sfrmWaterQualitypHCalibration, Me.cmdpHCal, Me.cmdSavepHCal, False

End Sub

Private Sub Form_Load()
On Error GoTo Error_Handler

    'Check for an existing Activity record and disable Riparian Veg Observations form if there isn't a record or there is a
    'record but nothing was observed. If there is an existing Activity record that states observations were made, enable
    'Observations forms.
    
    Dim ActivityExists As Boolean
    Dim YesLookupID As Integer

    ActivityExists = CheckRecExists(Me.RecordsetClone, "VisitID = " & Me.VisitID)
    YesLookupID = LookupIDFromCode("lookup_WaterQualityDataCollected", "Y")

    If ActivityExists = True And Me.cboWaterQualityDataCollectedID = YesLookupID And Not IsNull(Me.pHInstrumentID) Then
        EnableSubforms (True)
    Else
        EnableSubforms (False)
    End If

Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_Load" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboWaterQualityDataCollectedID_AfterUpdate()
On Error GoTo Error_Handler
    
    'If user selects "yes" there were invasives observed, enable invasives observation form.
    'If user selects "no" to indicate no water quality data collected, don't change choice and don't disable form if there
    'are measurement records.
    '3/22/2018 MEL converted to use combo box instead of option group

    Dim ObservationExists As Boolean
    Dim YesLookupID As Integer
    
    ObservationExists = Me.sfrmWaterQualitypH.Form.RowCount() > 0 Or _
                        Me.sfrmWaterQualityDO.Form.RowCount() > 0 Or _
                        Me.sfrmWaterQualitySpCond.Form.RowCount() > 0 Or _
                        Me.sfrmWaterQualityTemperature.Form.RowCount() > 0
    YesLookupID = LookupIDFromCode("lookup_WaterQualityDataCollected", "Y")

    If Me.cboWaterQualityDataCollectedID = YesLookupID Then
        If RequiredFieldsPopulated Then
            EnableSubforms (True)
        Else
            EnableSubforms (False)
        End If
    ElseIf ObservationExists Then 'User has selected no data collected
        MsgBox ("One or more Water Quality Measurements have been entered for this visit. " & Chr(13) + vbNewLine & _
        "If you are sure you want to change ""Water Quality Data Collected?"" to ""No"", please delete your measurements first."), vbOKOnly + vbExclamation, "Existing Records"
        cboWaterQualityDataCollectedID = YesLookupID
        EnableSubforms (True)
    Else 'no data collected and no measurements exist
        EnableSubforms (False)
    End If
    
    If RequiredFieldsPopulated Then
        DoCmd.Save acDefault
        Forms!frm_Visit!sfrmActivityDashboard.Form.Requery
    End If
    
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboWaterQualityDataCollectedID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboDataProcessingLevelID_AfterUpdate()
On Error GoTo Error_Handler

    'Call function to validate DPL changes; update intro tab dashboard when required
    'MEL - Version 2018-03-30a
    
    If fxnDPLUpdate(Me) = True Then
        DoCmd.RunCommand acCmdSaveRecord
        Forms!frm_Visit!sfrmActivityDashboard.Form.Requery
    Else
        Me.Undo
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboDataProcessingLevelID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub


Private Sub cbopHInstrumentID_AfterUpdate()
On Error GoTo Error_Handler
    
    If RequiredFieldsPopulated() Then
        EnableSubforms (True)
        RefreshCalibration
    Else
        EnableSubforms (False)
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cbopHInstrumentID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboDOInstrumentID_AfterUpdate()
On Error GoTo Error_Handler
    
    If RequiredFieldsPopulated() Then
        EnableSubforms (True)
        RefreshCalibration
    Else
        EnableSubforms (False)
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboDOInstrumentID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboSpCondInstrumentID_AfterUpdate()
On Error GoTo Error_Handler
    
    If RequiredFieldsPopulated() Then
        EnableSubforms (True)
        RefreshCalibration
    Else
        EnableSubforms (False)
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboSpCondInstrumentID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboTemperatureInstrumentID_AfterUpdate()
On Error GoTo Error_Handler
    
    If RequiredFieldsPopulated() Then
        EnableSubforms (True)
        RefreshCalibration
    Else
        EnableSubforms (False)
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboTemperatureInstrumentID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)

    'Requery the DPL date text box to force the date to show
    Me.txtdataprocessingleveldate.Requery

End Sub

Public Function EnableSubforms(bEnabled As Boolean)
    'Enable or disable water quality controls (mel 4/2018)
    On Error GoTo Error_Handler

        Me.sfrmWaterQualitypH.Enabled = bEnabled
        Me.sfrmWaterQualityDO.Enabled = bEnabled
        Me.sfrmWaterQualitySpCond.Enabled = bEnabled
        Me.sfrmWaterQualityTemperature.Enabled = bEnabled
        Me.sfrmWaterQualitypHCalibration.Enabled = bEnabled
        Me.sfrmWaterQualityDOCalibration.Enabled = bEnabled
        Me.sfrmWaterQualitySpCondCalibration.Enabled = bEnabled

Exit_Function:
    Exit Function
Error_Handler:
    Resume Exit_Function
End Function

Public Function RequiredFieldsPopulated() As Boolean
    'Check that required fields are populated to facilitate disabling subforms until requirements are met (mel 4/2018)
    On Error GoTo Error_Handler

        If Not IsNull(Me.cboWaterQualityDataCollectedID) And _
            Not IsNull(Me.cbopHInstrumentID) And _
            Not IsNull(Me.cboDOInstrumentID) And _
            Not IsNull(Me.cboSpCondInstrumentID) And _
            Not IsNull(Me.cboTemperatureInstrumentID) Then
                RequiredFieldsPopulated = True
        Else
            RequiredFieldsPopulated = False
        End If

Exit_Function:
    Exit Function
Error_Handler:
    Resume Exit_Function
End Function

Public Function RefreshCalibration()
    'Requery all of the calibration subforms (mel 4/2018)
    On Error GoTo Error_Handler

    Me.sfrmWaterQualityDOCalibration.Requery
    Me.sfrmWaterQualitypHCalibration.Requery
    Me.sfrmWaterQualitySpCondCalibration.Requery

Exit_Function:
    Exit Function
Error_Handler:
    Resume Exit_Function
End Function
