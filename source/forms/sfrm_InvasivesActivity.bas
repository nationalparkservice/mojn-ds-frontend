Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =15840
    DatasheetFontHeight =11
    ItemSuffix =11
    Left =765
    Top =2250
    Right =16875
    Bottom =11490
    DatasheetGridlinesColor =15921906
    RecSrcDt = Begin
        0x340b8c157915e540
    End
    RecordSource ="data_InvasivesActivity"
    Caption ="sfrm_InvasivesActivity"
    BeforeUpdate ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            CanGrow = NotDefault
            Height =9240
            BackColor =15921906
            Name ="Detail"
            AlternateBackColor =15921906
            Begin
                Begin Subform
                    CanGrow = NotDefault
                    OverlapFlags =215
                    OldBorderStyle =0
                    Left =240
                    Top =1140
                    Width =15530
                    Height =5404
                    BorderColor =65536
                    Name ="sfrmInvasivesObservations"
                    SourceObject ="Form.sfrm_InvasivesObservations"
                    LinkChildFields ="InvasivesActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =240
                    LayoutCachedTop =1140
                    LayoutCachedWidth =15770
                    LayoutCachedHeight =6544
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =93
                            Left =240
                            Top =840
                            Width =3420
                            Height =313
                            FontWeight =700
                            BackColor =4281912
                            BorderColor =6108695
                            ForeColor =16777215
                            Name ="lblsfrmInvasiveObservations"
                            Caption ="Invasive Observations"
                            GridlineColor =10921638
                            LayoutCachedLeft =240
                            LayoutCachedTop =840
                            LayoutCachedWidth =3660
                            LayoutCachedHeight =1153
                            BackThemeColorIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1199
                    Left =2880
                    Top =120
                    Width =1019
                    Height =315
                    FontSize =12
                    TabIndex =1
                    BorderColor =10921638
                    ForeColor =2108188
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    ConditionalFormat = Begin
                        0x01000000a8000000010000000100000000000000000000002300000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b0049006e00760061007300690076006500 ,
                        0x73004f006200730065007200760065006400490044005d0029003d0054007200 ,
                        0x7500650000000000
                    End
                    Name ="cboInvasivesObserved"
                    ControlSource ="InvasivesObservedID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT [lookup_InvasivesObserved].[ID], [lookup_InvasivesObserved].[Code], [look"
                        "up_InvasivesObserved].[Label] FROM lookup_InvasivesObserved ORDER BY [ID]; "
                    ColumnWidths ="0;0;1199"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =2880
                    LayoutCachedTop =120
                    LayoutCachedWidth =3899
                    LayoutCachedHeight =435
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded00220000004900 ,
                        0x73004e0075006c006c0028005b0049006e007600610073006900760065007300 ,
                        0x4f006200730065007200760065006400490044005d0029003d00540072007500 ,
                        0x6500000000000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            FontItalic = NotDefault
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =120
                            Width =2700
                            Height =320
                            FontSize =12
                            FontWeight =700
                            BorderColor =8355711
                            Name ="cboInvasivesObserved_Label"
                            Caption ="Were Invasives Observed?"
                            GridlineColor =10921638
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =2820
                            LayoutCachedHeight =440
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Top =540
                    Width =15840
                    Name ="Line9"
                    GridlineColor =10921638
                    LayoutCachedTop =540
                    LayoutCachedWidth =15840
                    LayoutCachedHeight =540
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =4496
                    Top =8160
                    Width =11105
                    Height =966
                    FontSize =10
                    TabIndex =2
                    BorderColor =14211288
                    Name ="txtDataProcessingLevelNote"
                    ControlSource ="DataProcessingLevelNote"
                    GridlineColor =10921638

                    LayoutCachedLeft =4496
                    LayoutCachedTop =8160
                    LayoutCachedWidth =15601
                    LayoutCachedHeight =9126
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =3900
                            Top =8164
                            Width =540
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLNote"
                            Caption ="Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =3900
                            LayoutCachedTop =8164
                            LayoutCachedWidth =4440
                            LayoutCachedHeight =8402
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1440
                    Left =1740
                    Top =8340
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =3
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="cboDataProcessingLevelID"
                    ControlSource ="DataProcessingLevelID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_DataProcessingLevel.ID, lookup_DataProcessingLevel.Code, lookup_Da"
                        "taProcessingLevel.Label FROM lookup_DataProcessingLevel; "
                    ColumnWidths ="0;0;1440"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =1740
                    LayoutCachedTop =8340
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =8578
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =480
                            Top =8340
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPL"
                            Caption ="*DPL"
                            GridlineColor =10921638
                            LayoutCachedLeft =480
                            LayoutCachedTop =8340
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =8578
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1740
                    Top =8640
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =4
                    BackColor =15921906
                    BorderColor =10921638
                    Name ="txtDataProcessingLevelDate"
                    ControlSource ="DataProcessingLevelDate"
                    Format ="Short Date"
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =1740
                    LayoutCachedTop =8640
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =8878
                    BackThemeColorIndex =-1
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =480
                            Top =8640
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLDate"
                            Caption ="*DPL Date"
                            GridlineColor =10921638
                            LayoutCachedLeft =480
                            LayoutCachedTop =8640
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =8878
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =0
                    OverlapFlags =255
                    Left =300
                    Top =8040
                    Width =15420
                    Height =1200
                    BorderColor =2500134
                    Name ="Box207"
                    GridlineColor =10921638
                    LayoutCachedLeft =300
                    LayoutCachedTop =8040
                    LayoutCachedWidth =15720
                    LayoutCachedHeight =9240
                    BorderThemeColorIndex =0
                    BorderTint =85.0
                    BorderShade =100.0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =247
                    TextAlign =2
                    Left =480
                    Top =7860
                    Width =2340
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="Label203"
                    Caption ="Data Processing Level"
                    GridlineColor =10921638
                    LayoutCachedLeft =480
                    LayoutCachedTop =7860
                    LayoutCachedWidth =2820
                    LayoutCachedHeight =8160
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =300
                    Top =7020
                    Width =15420
                    Height =723
                    TabIndex =5
                    BorderColor =14211288
                    ForeColor =4210752
                    Name ="Notes"
                    ControlSource ="Notes"
                    GridlineColor =10921638

                    LayoutCachedLeft =300
                    LayoutCachedTop =7020
                    LayoutCachedWidth =15720
                    LayoutCachedHeight =7743
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =300
                            Top =6840
                            Width =2160
                            Height =240
                            FontSize =8
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Label5"
                            Caption ="Invasives Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =300
                            LayoutCachedTop =6840
                            LayoutCachedWidth =2460
                            LayoutCachedHeight =7080
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =14520
                    Top =120
                    Width =300
                    Height =315
                    TabIndex =6
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="ID"
                    ControlSource ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =14520
                    LayoutCachedTop =120
                    LayoutCachedWidth =14820
                    LayoutCachedHeight =435
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Const mstrcFormName As String = "sfrm_InvasivesActivity"

Private Sub Form_Load()
On Error GoTo Error_Handler

    'Check for an existing Activity record and disable Invasives Observations form if there isn't a record or there is a
    'record but invasive species were not observed. If there is an existing Activity record that states invasives were observed, enable
    'Invasives Observations form.
    
    Dim ObservationExists As Boolean
    Dim ActivityExists As Boolean
    Dim YesLookupID As Integer
    Dim intNoLookup As Integer

    ActivityExists = CheckRecExists(Me.RecordsetClone, "VisitID = " & Me.VisitID)
    ObservationExists = CheckRecExists(Me.sfrmInvasivesObservations.Form.RecordsetClone, "InvasivesActivityID = " & Me.ID)
    YesLookupID = LookupIDFromCode("lookup_InvasivesObserved", "Y")


    If ActivityExists = True And Me.cboInvasivesObserved = YesLookupID Then
        Me.sfrmInvasivesObservations.Enabled = True
    Else
        Me.sfrmInvasivesObservations.Enabled = False
    End If

Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_Load" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)

    'Requery the DPL date text box to force the date to show
    Me.txtdataprocessingleveldate.Requery

End Sub

Private Sub cboInvasivesObserved_AfterUpdate()
On Error GoTo Error_Handler
    
    'If user selects "yes" there were invasives observed, enable invasives observation form.
    'If user selects "no" to indicate no invasives were observed, don't change choice and don't disable form if there
    'are observations records.
    '3/22/2018 MEL converted to use combo box instead of option group

    Dim ObservationExists As Boolean
    Dim YesLookupID As Integer
    
    ObservationExists = CheckRecExists(Me.sfrmInvasivesObservations.Form.RecordsetClone, "InvasivesActivityID = " & Me.ID)
    YesLookupID = LookupIDFromCode("lookup_InvasivesObserved", "Y")

    If Me.cboInvasivesObserved = YesLookupID Then
        Me.sfrmInvasivesObservations.Enabled = True
    ElseIf ObservationExists Then
        MsgBox ("One or more Invasive Species Observations have been entered for this visit. " & Chr(13) + vbNewLine & _
        "If you are sure you want to change ""Invasive Species Observed?"" to ""No"", please delete your Invasive Species Observations first."), vbOKOnly + vbExclamation, "Existing Records"
        Me.cboInvasivesObserved = YesLookupID
        Me.sfrmInvasivesObservations.Enabled = True
    Else
        Me.sfrmInvasivesObservations.Enabled = False
    End If
    
    DoCmd.Save acDefault
    Forms!frm_Visit!sfrmActivityDashboard.Form.Requery

Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboInvasivesObserved_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboDataProcessingLevelID_AfterUpdate()
On Error GoTo Error_Handler

    'Call function to validate DPL changes; update intro tab dashboard when required
    'MEL - Version 2018-03-30a
    
    If fxnDPLUpdate(Me) = True Then
        DoCmd.RunCommand acCmdSaveRecord
        Forms!frm_Visit!sfrmActivityDashboard.Form.Requery
    Else
        Me.Undo
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboDataProcessingLevelID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub
