Version =20
VersionRequired =20
Begin Form
    AutoResize = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    FilterOn = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =15840
    DatasheetFontHeight =11
    ItemSuffix =22
    Left =3915
    Top =2610
    Right =20025
    Bottom =11850
    DatasheetGridlinesColor =15921906
    RecSrcDt = Begin
        0x372b2ba47615e540
    End
    RecordSource ="data_DischargeActivity"
    BeforeUpdate ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin Chart
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ToggleButton
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =2
            Bevel =1
            BackColor =-1
            BackThemeColorIndex =4
            BackTint =60.0
            OldBorderStyle =0
            BorderLineStyle =0
            BorderColor =-1
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverColor =0
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedColor =0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeColor =0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeColor =0
            PressedForeThemeColorIndex =1
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            CanGrow = NotDefault
            Height =9240
            BackColor =15921906
            Name ="Detail"
            AlternateBackColor =14602694
            Begin
                Begin Subform
                    Visible = NotDefault
                    Enabled = NotDefault
                    CanGrow = NotDefault
                    OverlapFlags =223
                    OldBorderStyle =0
                    Left =180
                    Top =2040
                    Width =4863
                    Height =4350
                    TabIndex =4
                    BorderColor =10921638
                    Name ="sfrmDischargeVolumetric"
                    SourceObject ="Form.sfrm_DischargeVolumetric"
                    LinkChildFields ="DischargeActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =180
                    LayoutCachedTop =2040
                    LayoutCachedWidth =5043
                    LayoutCachedHeight =6390
                    Begin
                        Begin Label
                            Visible = NotDefault
                            FontItalic = NotDefault
                            OverlapFlags =93
                            Left =180
                            Top =1800
                            Width =2124
                            Height =239
                            FontSize =10
                            FontWeight =700
                            BorderColor =6108695
                            Name ="lblsfrmDischargeVolumetric"
                            Caption ="Volumetric Discharge"
                            GridlineColor =10921638
                            LayoutCachedLeft =180
                            LayoutCachedTop =1800
                            LayoutCachedWidth =2304
                            LayoutCachedHeight =2039
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ToggleButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    Left =180
                    Top =1260
                    Width =1320
                    Height =300
                    TabIndex =1
                    Name ="tgl_EstimatedDischarge"
                    Caption ="Estimated"
                    FontName ="Calibri"
                    OnClick ="[Event Procedure]"
                    LeftPadding =60
                    TopPadding =45
                    RightPadding =135
                    BottomPadding =135
                    GridlineColor =10921638

                    LayoutCachedLeft =180
                    LayoutCachedTop =1260
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =1560
                    ForeTint =100.0
                    Shape =1
                    Bevel =0
                    Gradient =12
                    BackColor =10855845
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =1
                    BorderColor =0
                    BorderThemeColorIndex =0
                    BorderTint =100.0
                    HoverColor =3355443
                    HoverThemeColorIndex =0
                    HoverTint =80.0
                    PressedColor =8965045
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =0
                    Shadow =-1
                    QuickStyle =22
                    QuickStyleMask =-49
                    WebImagePaddingTop =2
                    WebImagePaddingRight =4
                    WebImagePaddingBottom =1
                    Overlaps =1
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =180
                            Top =840
                            Width =4620
                            Height =300
                            BackColor =4281912
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="lblDischargeHeading"
                            Caption ="Discharge"
                            GridlineColor =10921638
                            LayoutCachedLeft =180
                            LayoutCachedTop =840
                            LayoutCachedWidth =4800
                            LayoutCachedHeight =1140
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ToggleButton
                    Enabled = NotDefault
                    OverlapFlags =87
                    Left =1620
                    Top =1260
                    Width =1320
                    Height =300
                    TabIndex =2
                    Name ="tgl_VolumetricDischarge"
                    Caption ="Volumetric"
                    FontName ="Calibri"
                    OnClick ="[Event Procedure]"
                    LeftPadding =60
                    TopPadding =45
                    RightPadding =135
                    BottomPadding =135
                    GridlineColor =10921638

                    LayoutCachedLeft =1620
                    LayoutCachedTop =1260
                    LayoutCachedWidth =2940
                    LayoutCachedHeight =1560
                    ForeTint =100.0
                    Shape =1
                    Bevel =0
                    Gradient =12
                    BackColor =10855845
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    OldBorderStyle =1
                    BorderColor =0
                    BorderThemeColorIndex =0
                    BorderTint =100.0
                    HoverColor =3355443
                    HoverThemeColorIndex =0
                    HoverTint =80.0
                    PressedColor =8965045
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    HoverForeTint =100.0
                    PressedForeThemeColorIndex =0
                    Shadow =-1
                    QuickStyle =22
                    QuickStyleMask =-49
                    WebImagePaddingTop =2
                    WebImagePaddingRight =4
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2880
                    Left =1740
                    Top =120
                    Width =2940
                    Height =299
                    FontSize =12
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    ConditionalFormat = Begin
                        0x01000000a0000000010000000100000000000000000000001f00000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b0046006c006f00770043006f006e006400 ,
                        0x6900740069006f006e00490044005d0029003d00540072007500650000000000
                    End
                    Name ="cboFlowConditionID"
                    ControlSource ="FlowConditionID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_FlowCondition.ID, lookup_FlowCondition.Label FROM lookup_FlowCondi"
                        "tion ORDER BY lookup_FlowCondition.Sort; "
                    ColumnWidths ="0;2880"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =1740
                    LayoutCachedTop =120
                    LayoutCachedWidth =4680
                    LayoutCachedHeight =419
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded001e0000004900 ,
                        0x73004e0075006c006c0028005b0046006c006f00770043006f006e0064006900 ,
                        0x740069006f006e00490044005d0029003d005400720075006500000000000000 ,
                        0x000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            FontItalic = NotDefault
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =120
                            Width =1557
                            Height =299
                            FontSize =12
                            FontWeight =700
                            BorderColor =6108695
                            Name ="lblFlowConditionID"
                            Caption ="Flow Condition"
                            GridlineColor =10921638
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =1677
                            LayoutCachedHeight =419
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    Enabled = NotDefault
                    CanGrow = NotDefault
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =6120
                    Top =1200
                    Width =4800
                    Height =5157
                    TabIndex =5
                    BorderColor =10921638
                    Name ="sfrmSpringbrookDimensions"
                    SourceObject ="Form.sfrm_SpringbrookDimensions"
                    LinkChildFields ="DischargeActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =6120
                    LayoutCachedTop =1200
                    LayoutCachedWidth =10920
                    LayoutCachedHeight =6357
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =6120
                            Top =840
                            Width =4440
                            Height =300
                            BackColor =4281912
                            BorderColor =8355711
                            ForeColor =16777215
                            Name ="lblSfrmSpringbrookDimensions"
                            Caption ="Springbrook Dimensions"
                            GridlineColor =10921638
                            LayoutCachedLeft =6120
                            LayoutCachedTop =840
                            LayoutCachedWidth =10560
                            LayoutCachedHeight =1140
                            BackThemeColorIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    Visible = NotDefault
                    Enabled = NotDefault
                    CanGrow = NotDefault
                    OverlapFlags =247
                    OldBorderStyle =0
                    Left =180
                    Top =2070
                    Width =3002
                    Height =752
                    TabIndex =3
                    BorderColor =10921638
                    Name ="sfrmDischargeEstimated"
                    SourceObject ="Form.sfrm_DischargeEstimated"
                    LinkChildFields ="DischargeActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =180
                    LayoutCachedTop =2070
                    LayoutCachedWidth =3182
                    LayoutCachedHeight =2822
                    Begin
                        Begin Label
                            Visible = NotDefault
                            FontItalic = NotDefault
                            OverlapFlags =223
                            Left =180
                            Top =1800
                            Width =2820
                            Height =299
                            FontSize =10
                            FontWeight =700
                            BorderColor =6108695
                            Name ="lblsfrmDischargeEstimated"
                            Caption ="Estimated  Discharge"
                            GridlineColor =10921638
                            LayoutCachedLeft =180
                            LayoutCachedTop =1800
                            LayoutCachedWidth =3000
                            LayoutCachedHeight =2099
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Top =540
                    Width =15840
                    Name ="lineHeader"
                    GridlineColor =10921638
                    LayoutCachedTop =540
                    LayoutCachedWidth =15840
                    LayoutCachedHeight =540
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =4496
                    Top =8160
                    Width =11105
                    Height =966
                    FontSize =10
                    TabIndex =8
                    BorderColor =14211288
                    Name ="txtDataProcessingLevelNote"
                    ControlSource ="DataProcessingLevelNote"
                    GridlineColor =10921638

                    LayoutCachedLeft =4496
                    LayoutCachedTop =8160
                    LayoutCachedWidth =15601
                    LayoutCachedHeight =9126
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =3900
                            Top =8164
                            Width =540
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLNote"
                            Caption ="Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =3900
                            LayoutCachedTop =8164
                            LayoutCachedWidth =4440
                            LayoutCachedHeight =8402
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1440
                    Left =1740
                    Top =8340
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =7
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="cboDataProcessingLevelID"
                    ControlSource ="DataProcessingLevelID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_DataProcessingLevel.ID, lookup_DataProcessingLevel.Code, lookup_Da"
                        "taProcessingLevel.Label FROM lookup_DataProcessingLevel; "
                    ColumnWidths ="0;0;1440"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =1740
                    LayoutCachedTop =8340
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =8578
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =480
                            Top =8340
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPL"
                            Caption ="*DPL"
                            GridlineColor =10921638
                            LayoutCachedLeft =480
                            LayoutCachedTop =8340
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =8578
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1740
                    Top =8640
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =9
                    BackColor =15921906
                    BorderColor =10921638
                    Name ="txtDataProcessingLevelDate"
                    ControlSource ="DataProcessingLevelDate"
                    Format ="Short Date"
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =1740
                    LayoutCachedTop =8640
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =8878
                    BackThemeColorIndex =-1
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =480
                            Top =8640
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLDate"
                            Caption ="*DPL Date"
                            GridlineColor =10921638
                            LayoutCachedLeft =480
                            LayoutCachedTop =8640
                            LayoutCachedWidth =1680
                            LayoutCachedHeight =8878
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =0
                    OverlapFlags =255
                    Left =300
                    Top =8040
                    Width =15420
                    Height =1200
                    BorderColor =2500134
                    Name ="Box207"
                    GridlineColor =10921638
                    LayoutCachedLeft =300
                    LayoutCachedTop =8040
                    LayoutCachedWidth =15720
                    LayoutCachedHeight =9240
                    BorderThemeColorIndex =0
                    BorderTint =85.0
                    BorderShade =100.0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =247
                    TextAlign =2
                    Left =480
                    Top =7860
                    Width =2340
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="lblDataProcessingLevelHeading"
                    Caption ="Data Processing Level"
                    GridlineColor =10921638
                    LayoutCachedLeft =480
                    LayoutCachedTop =7860
                    LayoutCachedWidth =2820
                    LayoutCachedHeight =8160
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =300
                    Top =7020
                    Width =15420
                    Height =723
                    TabIndex =6
                    BorderColor =14211288
                    ForeColor =4210752
                    Name ="txtNotes"
                    ControlSource ="Notes"
                    GridlineColor =10921638

                    LayoutCachedLeft =300
                    LayoutCachedTop =7020
                    LayoutCachedWidth =15720
                    LayoutCachedHeight =7743
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =300
                            Top =6840
                            Width =2160
                            Height =240
                            FontSize =8
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="lblNotesFooter"
                            Caption ="Discharge Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =300
                            LayoutCachedTop =6840
                            LayoutCachedWidth =2460
                            LayoutCachedHeight =7080
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =10920
                    Top =60
                    Width =300
                    Height =315
                    TabIndex =10
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="ID"
                    ControlSource ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =10920
                    LayoutCachedTop =60
                    LayoutCachedWidth =11220
                    LayoutCachedHeight =375
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Const mstrcFormName As String = "sfrm_DischargeActivity"

Public Function DataQualityOK() As Boolean
On Error GoTo Error_Handler

Dim flowCondition As String

If Me.NewRecord Then
    DataQualityOK = True
    GoTo Exit_Procedure
End If

flowCondition = Nz(LookupLabelFromID("lookup_FlowCondition", Me.cboFlowConditionID))

Select Case flowCondition
    Case "dry", "wet soil only", "flood", "standing water", "solid ice"
        DataQualityOK = Me.sfrmSpringbrookDimensions.Form.ConsistentWithParent(flowCondition) And _
                        Me.sfrmDischargeEstimated.Form.RowCount() = 0 And _
                        Me.sfrmDischargeVolumetric.Form.RowCount() = 0
    Case "flowing"
        DataQualityOK = Me.sfrmSpringbrookDimensions.Form.ConsistentWithParent(flowCondition) And _
                        ((Me.sfrmDischargeEstimated.Form.RowCount() > 0) Xor (Me.sfrmDischargeVolumetric.Form.RowCount() > 0)) And _
                        Me.sfrmDischargeEstimated.Form.DataQualityOK() And _
                        Me.sfrmDischargeVolumetric.Form.DataQualityOK()
    Case Else
        DataQualityOK = False
End Select

Exit_Procedure:
    Exit Function
Error_Handler:
    MsgBox "Module: " & mstrcFormName & vbNewLine & "Fxn: DataQualityOK" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Function

Private Function ValidateFlowCondition(flowCondition As String, estDischarge As Boolean, volDischarge As Boolean, springbrookFlag As Variant, springbrookLength As Variant, springbrookWidth As Variant) As Boolean
On Error GoTo Error_Handler

'Dim springbrookDimensionIsZero As Boolean
'Dim springbrookDimensionsExist As Boolean
'
'springbrookDimensionIsZero = (Not IsNull(springbrookWidth) And springbrookWidth = 0) _
'                                Or (Not IsNull(springbrookLength) And springbrookLength = 0)
'springbrookDimensionsExist = (Not IsNull(springbrookWidth) And springbrookWidth > 0) _
'                                Or (Not IsNull(springbrookLength) And springbrookLength > 0) _
'                                Or (Not IsNothing(springbrookFlag) And springbrookFlag = ">50m")
'
'Select Case flowCondition
'    Case "dry", "wet soil only"
'        'If discharge measurements exist, tell user to delete them before changing flow condition
'        If estDischarge Or volDischarge Then
'            MsgBox ("Cannot change flow condition to dry or wet soil because discharge data is present.")
'            ValidateFlowCondition = False
'        'If springbrook width or length is non-zero, confirm that it is ok to set those fields to 0
'        ElseIf springbrookDimensionsExist Then
'            ValidateFlowCondition = (MsgBox("You have entered data for springbrook dimensions. Changing flow condition to dry or wet soil will set these dimensions to zero. Are you sure you want to continue?", vbYesNo) = vbYes)
'        Else
'            ValidateFlowCondition = True
'        End If
'
'    Case "flowing"
'        'If springbrook width or length is 0, confirm that it is ok to clear that field
'        If springbrookDimensionIsZero Then
'            ValidateFlowCondition = (MsgBox("Springbrook dimensions are set to 0. Changing flow condition to flowing, flood, or standing water will clear these fields. Are you sure you want to continue?", vbYesNo) = vbYes)
'        Else
'            ValidateFlowCondition = True
'        End If
'    Case "flood", "standing water"
'        'If discharge measurements exist, tell user to delete them before changing flow condition
'        If estDischarge Or volDischarge Then
'            MsgBox ("Cannot change flow condition to flood or standing water because discharge data is present.")
'            ValidateFlowCondition = False
'        'If springbrook width or length is non-zero, confirm that it is ok to set those fields to 0
'        ElseIf springbrookDimensionIsZero Then
'            ValidateFlowCondition = (MsgBox("Springbrook dimensions are set to 0. Changing flow condition to flowing, flood, or standing water will clear these fields. Are you sure you want to continue?", vbYesNo) = vbYes)
'        Else
'            ValidateFlowCondition = True
'        End If
'End Select

Exit_Procedure:
        Exit Function
Error_Handler:
        MsgBox "Module: " & mstrcFormName & vbNewLine & "Sub:  ValidateFlowCondition" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
        Resume Exit_Procedure
End Function

Private Sub cboFlowConditionID_AfterUpdate()
On Error GoTo Error_Handler

    DoCmd.RunCommand acCmdSaveRecord
    Forms!frm_Visit!sfrmActivityDashboard.Form.Requery

Exit_Procedure:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboFlowConditionID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Sub

Private Sub Form_Load()
On Error GoTo Error_Handler
        
    'When main form opens, enable/disable forms and toggle buttons, according to business rules:
    'FlowConditionID is null: All forms and toggle buttons are disabled.
    'FlowConditionID = Dry, Wet Soil Only, Standing Water, or Flood: Enable Springbrook Dimensions form. Toggle buttons and Est/Vol forms should be disabled.
    'FlowDonditionID = Flowing: Enable Springbrook Dimensions form, toggle buttons, and Est/Vol forms according to existing data
    '(if no discharge data, sfrmDischargeEstimated is the default visible form).
    
    Dim EstDischargeExists As Boolean
    Dim VolDischargeExists As Boolean

    EstDischargeExists = Me.sfrmDischargeEstimated.Form.RowCount() > 0 'CheckRecExists(Me.sfrmDischargeEstimated.Form.RecordsetClone, "DischargeActivityID = " & Me.ID)
    VolDischargeExists = Me.sfrmDischargeVolumetric.Form.RowCount() > 0 'CheckRecExists(Me.sfrmDischargeVolumetric.Form.RecordsetClone, "DischargeActivityID = " & Me.ID)
    
    If IsNull(Me.FlowConditionID.Value) = True Then  'Flow condition not declared; disable all other controls
        EnableToggles (False)
        EnableEstimated (False)
        EnableVolumetric (False)
        EnableSpringbrook (False)
        GoTo Exit_Procedure
    End If
    
    If Me.FlowConditionID.Value = LookupIDFromLabel("lookup_FlowCondition", "flowing") Then
        If VolDischargeExists Then
            EnableToggles (True)
            EnableEstimated (False)
            EnableVolumetric (True)
            EnableSpringbrook (True)
        Else   'If Volumetric measurement doesn't exist assume Estimated or None; Turn on estimated (the default)
            EnableToggles (True)
            EnableEstimated (True)
            EnableVolumetric (False)
            EnableSpringbrook (True)
        End If
    Else
        'Dry, Wet Soil Only, Standing Water, or Flood; Enable only Springbrook
        EnableToggles (False)
        EnableEstimated (False)
        EnableVolumetric (False)
        EnableSpringbrook (True)
    End If
    
Exit_Procedure:
        Exit Sub
Error_Handler:
        MsgBox "Module: " & mstrcFormName & vbNewLine & "Sub:  Form_Load" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
        Resume Exit_Procedure
End Sub

Private Sub cboFlowConditionID_BeforeUpdate(Cancel As Integer)
On Error GoTo Error_Handler

    'If Flow Condition ID = dry or wet soil only, Estimated Discharge & Volumetric forms, and toggle buttons are disabled
    'If Flow Condition ID = standing water or flood, Est/Vol forms, and toggles are still disabled.
    'If Flow Condition ID flowing, Est/Vol forms, and toggles are enabled.
    ' 1-dry, 2-wet soil only, 3-standing water, 4-flowing, 5-flood
    
    'Case where flow condition is not flowing, but discharge measurements exist is trapped in BeforeUpdate

    Dim flowCondition As String
    Dim EstDischargeExists As Boolean
    Dim VolDischargeExists As Boolean
    
    flowCondition = Nz(LookupLabelFromID("lookup_FlowCondition", Me.cboFlowConditionID))
    EstDischargeExists = Me.sfrmDischargeEstimated.Form.RowCount() > 0
    VolDischargeExists = Me.sfrmDischargeVolumetric.Form.RowCount() > 0
      
    Select Case flowCondition
        Case "flowing"
            EnableToggles True, EstDischargeExists, VolDischargeExists
            EnableEstimated (EstDischargeExists)
            EnableVolumetric (VolDischargeExists)
        
        Case "flood", "standing water", "dry", "wet soil only", "solid ice"
            If (Not EstDischargeExists) And (Not VolDischargeExists) Then
                EnableToggles False
                EnableEstimated (False)
                EnableVolumetric (False)
            Else
                MsgBox ("Please delete discharge data before attempting to change flow condition from 'flowing'")
                Cancel = True
                Me.cboFlowConditionID.Undo
                GoTo Exit_Procedure
            End If
        Case Else
            Cancel = True
            Me.cboFlowConditionID.Undo
            GoTo Exit_Procedure
    End Select
    
    EnableSpringbrook (True)
    
Exit_Procedure:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboFlowConditionID_BeforeUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
On Error GoTo Error_Handler

'Requery the DPL date text box to force the date to show
Me.txtdataprocessingleveldate.Requery

Exit_Procedure:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_BeforeUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Sub

Private Sub tgl_EstimatedDischarge_Click()
On Error GoTo Error_Handler
'Check for existing data before allowing change to discharge measurement method

Dim EstDischargeExists As Boolean
Dim VolDischargeExists As Boolean

EstDischargeExists = Me.sfrmDischargeEstimated.Form.RowCount() > 0
VolDischargeExists = Me.sfrmDischargeVolumetric.Form.RowCount() > 0

'No estimated discharge data, no volumetric discharge data -> toggle est. discharge visibility based on toggle button value
If Not EstDischargeExists And Not VolDischargeExists Then
    EnableEstimated (Me.tgl_EstimatedDischarge.Value)
    EnableVolumetric (False)
    Me.tgl_VolumetricDischarge.Value = False
'Estimated discharge data, no volumetric discharge data -> keep estimated subform visible
ElseIf EstDischargeExists And Not VolDischargeExists Then
    EnableEstimated (True)
    EnableVolumetric (False)
    Me.tgl_EstimatedDischarge.Value = True
    Me.tgl_VolumetricDischarge.Value = False
'Volumetric discharge data -> error; enable volumetric form
ElseIf VolDischargeExists Then
    EnableEstimated (False)
    EnableVolumetric (True)
    Me.tgl_EstimatedDischarge.Value = False
    Me.tgl_VolumetricDischarge.Value = True
    MsgBox ("Estimated discharge data cannot be entered because volumetric discharge data already exists.")
End If
    
Exit_Procedure:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  tgl_EstimatedDischarge_Click" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Sub

Private Sub tgl_VolumetricDischarge_Click()
On Error GoTo Error_Handler
'Check for existing data before allowing change to discharge measurement method

Dim EstDischargeExists As Boolean
Dim VolDischargeExists As Boolean

EstDischargeExists = Me.sfrmDischargeEstimated.Form.RowCount() > 0
VolDischargeExists = Me.sfrmDischargeVolumetric.Form.RowCount() > 0

'No estimated discharge data, no volumetric discharge data -> toggle vol. discharge visibility based on toggle button value
If Not EstDischargeExists And Not VolDischargeExists Then
    EnableVolumetric (Me.tgl_VolumetricDischarge.Value)
    EnableEstimated (False)
    Me.tgl_EstimatedDischarge.Value = False
'Estimated volumetric data, no estimated discharge data -> keep volumetric subform visible
ElseIf VolDischargeExists And Not EstDischargeExists Then
    EnableVolumetric (True)
    EnableEstimated (False)
    Me.tgl_VolumetricDischarge.Value = True
    Me.tgl_EstimatedDischarge.Value = False
'Estimated discharge data -> error; enable estimated form
ElseIf EstDischargeExists Then
    EnableVolumetric (False)
    EnableEstimated (True)
    Me.tgl_VolumetricDischarge.Value = False
    Me.tgl_EstimatedDischarge.Value = True
    MsgBox ("Volumetric discharge data cannot be entered because estimated discharge data already exists.")
End If
    
Exit_Procedure:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  tgl_VolumetricDischarge_Click" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Sub

Private Sub cboDataProcessingLevelID_AfterUpdate()
On Error GoTo Error_Handler

'Call function to validate DPL changes; update intro tab dashboard when required
'MEL - Version 2018-03-30a

If fxnDPLUpdate(Me) = True Then
    DoCmd.RunCommand acCmdSaveRecord
    Forms!frm_Visit!sfrmActivityDashboard.Form.Requery
Else
    Me.Undo
End If
        
Exit_Procedure:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboDataProcessingLevelID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Sub

Public Function EnableToggles(bEnabled As Boolean, Optional estimatedExists As Boolean = False, Optional volumetricExists As Boolean = False)
On Error GoTo Error_Handler

'Enable or disable discharge method toggle buttons (mel 4/2018)

Me.tgl_EstimatedDischarge.Enabled = bEnabled
Me.tgl_EstimatedDischarge.Value = estimatedExists And bEnabled
Me.tgl_VolumetricDischarge.Enabled = bEnabled
Me.tgl_VolumetricDischarge.Value = volumetricExists And bEnabled

Exit_Procedure:
    Exit Function
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  EnableToggles" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Function

Public Function EnableVolumetric(bEnabled As Boolean)
On Error GoTo Error_Handler
    'Enable or disable discharge method toggle buttons (mel 4/2018)

    Me.sfrmDischargeVolumetric.Visible = bEnabled
    Me.sfrmDischargeVolumetric.Enabled = bEnabled
    Me.lblsfrmDischargeVolumetric.Visible = bEnabled
        
Exit_Procedure:
    Exit Function
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  EnableVolumetric" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Function

Public Function EnableEstimated(bEnabled As Boolean)
On Error GoTo Error_Handler
    'Enable or disable discharge method toggle buttons (mel 4/2018)
    
    Me.sfrmDischargeEstimated.Visible = bEnabled
    Me.sfrmDischargeEstimated.Enabled = bEnabled
    Me.lblsfrmDischargeEstimated.Visible = bEnabled
        
Exit_Procedure:
    Exit Function
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  EnableEstimated" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Function


Public Function EnableSpringbrook(bEnabled As Boolean)
On Error GoTo Error_Handler
    'Enable or disable springbrook dimensions subform (mel 4/2018)
    
    Me.sfrmSpringbrookDimensions.Enabled = bEnabled
    Me.sfrmSpringbrookDimensions.Visible = True
    Me.lblSfrmSpringbrookDimensions.Visible = True
        
Exit_Procedure:
    Exit Function
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  EnableEstimated" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure
End Function
