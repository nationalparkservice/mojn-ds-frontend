Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    FilterOn = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =12577
    DatasheetFontHeight =11
    ItemSuffix =3
    Left =2610
    Top =2400
    Right =15375
    Bottom =10050
    DatasheetGridlinesColor =15921906
    RecSrcDt = Begin
        0x635d03656f15e540
    End
    RecordSource ="data_RepeatPhotoActivity"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            CanGrow = NotDefault
            Height =7770
            BackColor =15527148
            Name ="Detail"
            AlternateBackColor =14602694
            Begin
                Begin ComboBox
                    ColumnHeads = NotDefault
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =4
                    ListRows =25
                    ListWidth =4032
                    Left =1584
                    Top =120
                    Width =1980
                    Height =285
                    FontSize =10
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"80\""
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    Name ="cboCameraID"
                    ControlSource ="CameraID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ref_Camera.ID, ref_Camera.Label, ref_Camera.Manufacturer, ref_Camera.Mode"
                        "l, ref_Camera.SortOrder FROM ref_Camera ORDER BY ref_Camera.SortOrder; "
                    ColumnWidths ="0;1296;1296;1440"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =1584
                    LayoutCachedTop =120
                    LayoutCachedWidth =3564
                    LayoutCachedHeight =405
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =119
                            Top =120
                            Width =1380
                            Height =240
                            FontSize =10
                            BorderColor =8355711
                            Name ="lblCameraID"
                            Caption ="*Camera"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =119
                            LayoutCachedTop =120
                            LayoutCachedWidth =1499
                            LayoutCachedHeight =360
                            ThemeFontIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =4
                    ListRows =25
                    ListWidth =3168
                    Left =1584
                    Top =420
                    Width =1980
                    Height =285
                    FontSize =10
                    TabIndex =1
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"100\""
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    Name ="cboCameraCardID"
                    ControlSource ="CameraCardID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ref_CameraCard.ID, ref_CameraCard.Label, ref_CameraCard.Manufacturer, ref"
                        "_CameraCard.CardType FROM ref_CameraCard; "
                    ColumnWidths ="0;864;1296;1008"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =1584
                    LayoutCachedTop =420
                    LayoutCachedWidth =3564
                    LayoutCachedHeight =705
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =119
                            Top =420
                            Width =1395
                            Height =240
                            FontSize =10
                            BorderColor =8355711
                            Name ="lblCameraCard"
                            Caption ="*Camera Card"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =119
                            LayoutCachedTop =420
                            LayoutCachedWidth =1514
                            LayoutCachedHeight =660
                            ThemeFontIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    Enabled = NotDefault
                    CanGrow = NotDefault
                    OverlapFlags =87
                    OldBorderStyle =0
                    SpecialEffect =2
                    Left =120
                    Top =1080
                    Width =12457
                    Height =3600
                    TabIndex =2
                    BorderColor =65536
                    Name ="sfrmRepeatPhotoObservations"
                    SourceObject ="Form.sfrm_RepeatPhotoObservations"
                    LinkChildFields ="RepeatPhotoActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =120
                    LayoutCachedTop =1080
                    LayoutCachedWidth =12577
                    LayoutCachedHeight =4680
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =120
                            Top =840
                            Width =2700
                            Height =240
                            FontSize =10
                            FontWeight =700
                            BorderColor =8355711
                            Name ="lblObservationsSubform"
                            Caption ="Repeat Photo Observations"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =120
                            LayoutCachedTop =840
                            LayoutCachedWidth =2820
                            LayoutCachedHeight =1080
                            ThemeFontIndex =-1
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1440
                    Left =2041
                    Top =5292
                    Width =2220
                    Height =238
                    FontSize =10
                    TabIndex =3
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    Name ="cboDataProcessingLevelID"
                    ControlSource ="DataProcessingLevelID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_DataProcessingLevel.ID, lookup_DataProcessingLevel.Code, lookup_Da"
                        "taProcessingLevel.Label FROM lookup_DataProcessingLevel; "
                    ColumnWidths ="0;0;1440"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =2041
                    LayoutCachedTop =5292
                    LayoutCachedWidth =4261
                    LayoutCachedHeight =5530
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OldBorderStyle =1
                            OverlapFlags =93
                            Left =241
                            Top =5292
                            Width =1575
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPL"
                            Caption ="*DPL"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =241
                            LayoutCachedTop =5292
                            LayoutCachedWidth =1816
                            LayoutCachedHeight =5530
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    IMESentenceMode =3
                    Left =2041
                    Top =5592
                    Width =2220
                    Height =238
                    FontSize =10
                    TabIndex =4
                    BorderColor =10921638
                    Name ="txtDataProcessingLevelDate"
                    ControlSource ="DataProcessingLevelDate"
                    Format ="Short Date"
                    FontName ="Arial"
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =2041
                    LayoutCachedTop =5592
                    LayoutCachedWidth =4261
                    LayoutCachedHeight =5830
                    BackThemeColorIndex =-1
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OldBorderStyle =1
                            OverlapFlags =93
                            Left =241
                            Top =5592
                            Width =1575
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLDate"
                            Caption ="*DPL Date"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =241
                            LayoutCachedTop =5592
                            LayoutCachedWidth =1816
                            LayoutCachedHeight =5830
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =6421
                    Top =5292
                    Width =5472
                    Height =1443
                    FontSize =10
                    TabIndex =5
                    BorderColor =10921638
                    Name ="txtDataProcessingLevelNote"
                    ControlSource ="DataProcessingLevelNote"
                    FontName ="Arial"
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =6421
                    LayoutCachedTop =5292
                    LayoutCachedWidth =11893
                    LayoutCachedHeight =6735
                    BackThemeColorIndex =-1
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OldBorderStyle =1
                            OverlapFlags =93
                            Left =4704
                            Top =5292
                            Width =1575
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLNotes"
                            Caption ="DPL Comments"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =4704
                            LayoutCachedTop =5292
                            LayoutCachedWidth =6279
                            LayoutCachedHeight =5530
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    SpecialEffect =0
                    OverlapFlags =247
                    Left =120
                    Top =5052
                    Width =12024
                    Height =1836
                    TabIndex =7
                    BorderColor =65536
                    Name ="fraDPLRepeatPhotos"
                    GridlineColor =10921638

                    LayoutCachedLeft =120
                    LayoutCachedTop =5052
                    LayoutCachedWidth =12144
                    LayoutCachedHeight =6888
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =420
                            Top =4932
                            Width =2280
                            Height =240
                            FontSize =10
                            FontWeight =700
                            BackColor =15527148
                            BorderColor =65536
                            Name ="lblDPLFrame"
                            Caption ="Data Processing Level"
                            FontName ="Arial"
                            GridlineColor =10921638
                            LayoutCachedLeft =420
                            LayoutCachedTop =4932
                            LayoutCachedWidth =2700
                            LayoutCachedHeight =5172
                            ThemeFontIndex =-1
                            BackThemeColorIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =3794
                    Top =7020
                    Width =4320
                    Height =528
                    FontSize =10
                    FontWeight =700
                    TabIndex =6
                    Name ="cmdDeleteRepeatPhotoEvent"
                    Caption ="Delete ALL Repeat Photo data for this visit"
                    FontName ="Arial"
                    ControlTipText ="Delete Record"
                    GridlineColor =10921638

                    LayoutCachedLeft =3794
                    LayoutCachedTop =7020
                    LayoutCachedWidth =8114
                    LayoutCachedHeight =7548
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    BackColor =10855845
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =14136213
                    ThemeFontIndex =-1
                    HoverColor =7961551
                    HoverThemeColorIndex =-1
                    HoverTint =100.0
                    PressedColor =10855845
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const mstrcFormName As String = "sfrmRepeatPhotoActivity"


Private Sub Form_Load()
        
On Error GoTo Error_Handler

    Dim RepeatPhotoObservationsExists As Boolean
    
    RepeatPhotoObservationsExists = CheckRecExists(Me.sfrmRepeatPhotoObservations.Form.Recordset, "RepeatPhotoActivityID = " & Me.VisitID)
    
    'If something is selected for both CameraID and CameraCardID, enable Repeat Photo Observations form
    'Enable Repeat Photos Observations form when something is selected for both camera and camera card
    If Not IsNull(Me.cboCameraID And Me.CameraCardID) Then
        Me.sfrmRepeatPhotoObservations.Enabled = True
        If RepeatPhotoObservationsExists Then
            Me.sfrmRepeatPhotoObservations.Form.sfrmRepeatPhoto.Enabled = True
        Else
            Me.sfrmRepeatPhotoObservations.Form.sfrmRepeatPhoto.Enabled = False
        End If
    Else
        Me.sfrmRepeatPhotoObservations.Enabled = False
    End If

Exit_Sub:
    Exit Sub

Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_Load" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub

End Sub

Private Sub cboCameraCardID_AfterUpdate()

On Error GoTo Error_Handler

    'Enable Repeat Photos Observations form when something is selected for both camera and camera card
    If Not IsNull(Me.cboCameraID And Me.CameraCardID) Then
        Me.sfrmRepeatPhotoObservations.Enabled = True
    Else
        Me.sfrmRepeatPhotoObservations.Enabled = False
    End If
    
Exit_Sub:
    Exit Sub
    
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboCameraCardID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub

End Sub

Private Sub cboCameraID_AfterUpdate()
    
On Error GoTo Error_Handler

    If Me.cboCameraID = 2 Or Me.cboCameraID = 3 Then
        Me.cboCameraCardID.RowSource = "SELECT ref_CameraCard.ID, ref_CameraCard.Label, ref_CameraCard.Manufacturer, ref_CameraCard.CardType FROM ref_CameraCard WHERE ref_CameraCard.CardType LIKE 'xd%' OR ref_CameraCard.CardType LIKE 'N/A';"
    ElseIf Me.cboCameraID = 4 Or Me.cboCameraID = 6 Then
        Me.cboCameraCardID.RowSource = "SELECT ref_CameraCard.ID, ref_CameraCard.Label, ref_CameraCard.Manufacturer, ref_CameraCard.CardType FROM ref_CameraCard WHERE ref_CameraCard.CardType LIKE 'sd%' OR ref_CameraCard.CardType LIKE 'N/A';"
    Else
        Me.cboCameraCardID.RowSource = "SELECT ref_CameraCard.ID, ref_CameraCard.Label, ref_CameraCard.Manufacturer, ref_CameraCard.CardType FROM ref_CameraCard;"
    End If
    
Exit_Sub:
    Exit Sub
    
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboCameraID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
    
End Sub

Private Sub cboDataProcessingLevelID_AfterUpdate()
    
'LC, 12/15/2017: Added logic to handle changes to DPL

On Error GoTo Error_Handler

    Dim intDPLOld As Integer
    Dim intDPLNew As Integer
    Dim intDPLNote As Boolean
    
    'Collect current and former DPL ID
    intDPLOld = Me.cboDataProcessingLevelID.OldValue
    intDPLNew = Me.cboDataProcessingLevelID.Value

    'Check to see if comment box is null; an explanation is required if DPL goes from Provisional back to Raw
    If Not IsNull(Me.txtdataprocessinglevelnote) Then
        intDPLNote = True
    Else
        intDPLNote = False
    End If
                
    'If function resolves to "true", DPL change goes through
    If fxnDPLChange(intDPLOld, intDPLNew, intDPLNote) = True Then
        Me.txtdataprocessingleveldate = Now
    Else
        Me.Undo
    End If
        
Exit_Sub:
    Exit Sub
    
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboDataProcessingLevelID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
        
End Sub

Private Sub cmdDeleteRepeatPhotoActivity_Click()

'Delete all Repeat Photo data, associated with a visit, from data_RepeatPhotoActivity, data_RepeatPhotoObservation, and data_RepeatPhoto
    
    On Error Resume Next
    
    Dim YesNo As Integer
    
    If IsNull(Me.VisitID) Then
        Resume Next
    'If user clicks delete Activity button and there are unsaved changes, save the record and then prompt the user to indicate it they're sure they want to get rid of the record.
    Else
        If Not IsNull(Me.VisitID) And Me.Dirty = True Then
            DoCmd.RunCommand acCmdSaveRecord
            YesNo = MsgBox("You are about to delete ALL Repeat Photos data for this visit, which may include Camera/Camera Card information, Observations, Photo File #s, and Data Processing Level." & Chr(13) + vbNewLine _
            & "If you click Yes, you won't be able to undo this Delete operation." & Chr(13) _
            & "Are you sure you want to delete this record?", vbYesNo + vbExclamation, "Delete Repeat Photos Record?")
                If YesNo = vbYes Then
                    CurrentDb.Execute "Delete * from data_RepeatPhotoActivity where VisitID = " & Me.VisitID, dbSeeChanges
                    Me.sfrmRepeatPhotoObservations.Enabled = False
                    Me.sfrmRepeatPhotoObservations.Form.sfrmRepeatPhoto.Enabled = False
                    Me.Requery
                Else
                    Me.Undo
                End If
        'If no unsaved changes, prompt user to indicate if they're sure they want to delete record.
        Else
            YesNo = MsgBox("You are about to delete ALL Repeat Photos data for this visit, which may include Camera/Camera Card information, Observations, Photo File #s, and Data Processing Level." & Chr(13) + vbNewLine _
            & "If you click Yes, you won't be able to undo this Delete operation." & Chr(13) _
            & "Are you sure you want to delete this record?", vbYesNo + vbExclamation, "Delete Repeat Photos Record?")
                If YesNo = vbYes Then
                    CurrentDb.Execute "Delete * from data_RepeatPhotoActivity where VisitID = " & Me.VisitID, dbSeeChanges
                    Me.sfrmRepeatPhotoObservations.Enabled = False
                    Me.sfrmRepeatPhotoObservations.Form.sfrmRepeatPhoto.Enabled = False
                    Me.Requery
                Else
                    Me.Undo
                End If
        End If
    End If
    
End Sub

Private Sub Form_AfterUpdate()
    
On Error GoTo Error_Handler

    Dim RepeatPhotoObservationsExists As Boolean
    
    RepeatPhotoObservationsExists = CheckRecExists(Me.sfrmRepeatPhotoObservations.Form.Recordset, "RepeatPhotoActivityID = " & Me.VisitID)

    'Enable Repeat Photos Observations form when something is selected for both camera and camera card
    'Enable Repeat Photo form if observations records exist
    If Not IsNull(Me.cboCameraID And Me.CameraCardID) Then
        Me.sfrmRepeatPhotoObservations.Enabled = True
        If RepeatPhotoObservationsExists Then
            Me.sfrmRepeatPhotoObservations.Form.sfrmRepeatPhoto.Enabled = True
        Else
            Me.sfrmRepeatPhotoObservations.Form.sfrmRepeatPhoto.Enabled = False
        End If
    Else
        Me.sfrmRepeatPhotoObservations.Enabled = False
    End If
    
Exit_Sub:
    Exit Sub
    
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
    
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
       
    'Requery the DPL date text box to force the date to show
Me.txtdataprocessingleveldate.Requery
    
End Sub
