SELECT ref_sensor.Label AS SensorNumber, IIf([data_visit].[visitdate]>[data_Visit_1].[visitdate] Or IsNull([data_Visit_1].[visitdate]),[data_visit].[visitdate],[data_Visit_1].[visitdate]) AS MostRecentVisitDate, data_site.Code AS SpringCode, data_site.Name AS SiteName, data_sensordeployment.VisitID, data_sensorretrievalattempt.SensorDeploymentID, lookup_issensorretrieved.code AS SensorRetrieved, ref_sensor.id AS SensorID
FROM (((((ref_sensor LEFT JOIN data_sensordeployment ON ref_sensor.id = data_sensordeployment.sensorid) LEFT JOIN data_visit ON data_sensordeployment.visitid = data_visit.id) LEFT JOIN data_site ON data_visit.siteid = data_site.id) LEFT JOIN data_sensorretrievalattempt ON data_sensordeployment.visitid = data_sensorretrievalattempt.sensordeploymentid) LEFT JOIN lookup_issensorretrieved ON data_sensorretrievalattempt.issensorretrieved = lookup_issensorretrieved.id) LEFT JOIN data_visit AS data_Visit_1 ON data_sensorretrievalattempt.visitid = data_Visit_1.id
ORDER BY ref_sensor.Label;

