Version =20
VersionRequired =20
Begin Form
    AutoResize = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =15840
    DatasheetFontHeight =11
    ItemSuffix =21
    Left =3075
    Top =3315
    Right =18930
    Bottom =12300
    DatasheetGridlinesColor =15921906
    RecSrcDt = Begin
        0x51f3cbe4ac15e540
    End
    RecordSource ="data_RiparianVegetationActivity"
    BeforeUpdate ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Section
            Height =9240
            BackColor =15921906
            Name ="Detail"
            AlternateBackColor =15921906
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =3852
                    Top =540
                    Width =1185
                    Height =313
                    BorderColor =14211288
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"20\""
                    ConditionalFormat = Begin
                        0x01000000a6000000010000000100000000000000000000002200000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b004d006900730074006c00650074006f00 ,
                        0x6500500072006500730065006e007400490044005d0029003d00540072007500 ,
                        0x650000000000
                    End
                    Name ="cboIsMistletoePresent"
                    ControlSource ="MistletoePresentID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_MistletoePresent.ID, lookup_MistletoePresent.Label FROM lookup_Mis"
                        "tletoePresent ORDER BY lookup_MistletoePresent.Label; "
                    ColumnWidths ="0;1440"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =3852
                    LayoutCachedTop =540
                    LayoutCachedWidth =5037
                    LayoutCachedHeight =853
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded00210000004900 ,
                        0x73004e0075006c006c0028005b004d006900730074006c00650074006f006500 ,
                        0x500072006500730065006e007400490044005d0029003d005400720075006500 ,
                        0x000000000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =1860
                            Top =540
                            Width =1926
                            Height =313
                            BorderColor =6108695
                            Name ="lblMistletoe"
                            Caption ="*Mistletoe Present?"
                            GridlineColor =10921638
                            LayoutCachedLeft =1860
                            LayoutCachedTop =540
                            LayoutCachedWidth =3786
                            LayoutCachedHeight =853
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Subform
                    Enabled = NotDefault
                    CanGrow = NotDefault
                    OverlapFlags =85
                    OldBorderStyle =0
                    Left =240
                    Top =1620
                    Width =13796
                    Height =4255
                    TabIndex =1
                    BorderColor =65536
                    Name ="sfrmRiparianVegetationObservation"
                    SourceObject ="Form.sfrm_RiparianVegetationObservation"
                    LinkChildFields ="RiparianVegetationActivityID"
                    LinkMasterFields ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =240
                    LayoutCachedTop =1620
                    LayoutCachedWidth =14036
                    LayoutCachedHeight =5875
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =2
                            Left =240
                            Top =1200
                            Width =3240
                            Height =300
                            FontWeight =700
                            BackColor =4281912
                            BorderColor =6108695
                            ForeColor =16777215
                            Name ="lblObservationSubform"
                            Caption ="Riparian Vegetation Observations"
                            GridlineColor =10921638
                            LayoutCachedLeft =240
                            LayoutCachedTop =1200
                            LayoutCachedWidth =3480
                            LayoutCachedHeight =1500
                            BackThemeColorIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    ColumnCount =3
                    Left =3837
                    Top =120
                    Width =1199
                    Height =313
                    FontSize =12
                    TabIndex =2
                    BorderColor =14211288
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"50\""
                    ConditionalFormat = Begin
                        0x01000000ae000000010000000100000000000000000000002600000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x490073004e0075006c006c0028005b0049007300560065006700650074006100 ,
                        0x740069006f006e004f006200730065007200760065006400490044005d002900 ,
                        0x3d00540072007500650000000000
                    End
                    Name ="cboIsVegetationObserved"
                    ControlSource ="IsVegetationObservedID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_IsVegetationObserved.ID, lookup_IsVegetationObserved.Code, lookup_"
                        "IsVegetationObserved.Label FROM lookup_IsVegetationObserved ORDER BY lookup_IsVe"
                        "getationObserved.Label; "
                    ColumnWidths ="0;0;1199"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =3837
                    LayoutCachedTop =120
                    LayoutCachedWidth =5036
                    LayoutCachedHeight =433
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000100000000000000f9eded00250000004900 ,
                        0x73004e0075006c006c0028005b00490073005600650067006500740061007400 ,
                        0x69006f006e004f006200730065007200760065006400490044005d0029003d00 ,
                        0x5400720075006500000000000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            FontItalic = NotDefault
                            OverlapFlags =85
                            TextAlign =1
                            Left =120
                            Top =120
                            Width =3660
                            Height =313
                            FontSize =12
                            FontWeight =700
                            BorderColor =6108695
                            Name ="Label19"
                            Caption ="Was Riparian Vegetation Observed?"
                            GridlineColor =10921638
                            LayoutCachedLeft =120
                            LayoutCachedTop =120
                            LayoutCachedWidth =3780
                            LayoutCachedHeight =433
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =4436
                    Top =8160
                    Width =11105
                    Height =966
                    FontSize =10
                    TabIndex =3
                    BorderColor =14211288
                    Name ="txtDataProcessingLevelNote"
                    ControlSource ="DataProcessingLevelNote"
                    GridlineColor =10921638

                    LayoutCachedLeft =4436
                    LayoutCachedTop =8160
                    LayoutCachedWidth =15541
                    LayoutCachedHeight =9126
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =3840
                            Top =8164
                            Width =540
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLNote"
                            Caption ="Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =3840
                            LayoutCachedTop =8164
                            LayoutCachedWidth =4380
                            LayoutCachedHeight =8402
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1440
                    Left =1680
                    Top =8340
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =4
                    BorderColor =10921638
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="cboDataProcessingLevelID"
                    ControlSource ="DataProcessingLevelID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_DataProcessingLevel.ID, lookup_DataProcessingLevel.Code, lookup_Da"
                        "taProcessingLevel.Label FROM lookup_DataProcessingLevel; "
                    ColumnWidths ="0;0;1440"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =1680
                    LayoutCachedTop =8340
                    LayoutCachedWidth =3660
                    LayoutCachedHeight =8578
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =420
                            Top =8340
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPL"
                            Caption ="*DPL"
                            GridlineColor =10921638
                            LayoutCachedLeft =420
                            LayoutCachedTop =8340
                            LayoutCachedWidth =1620
                            LayoutCachedHeight =8578
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1680
                    Top =8640
                    Width =1980
                    Height =238
                    FontSize =10
                    TabIndex =5
                    BackColor =15921906
                    BorderColor =10921638
                    Name ="txtDataProcessingLevelDate"
                    ControlSource ="DataProcessingLevelDate"
                    Format ="Short Date"
                    ConditionalFormat = Begin
                        0x0100000064000000010000000200000000000000000000000100000001000000 ,
                        0x00000000f9eded00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =1680
                    LayoutCachedTop =8640
                    LayoutCachedWidth =3660
                    LayoutCachedHeight =8878
                    BackThemeColorIndex =-1
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    ConditionalFormat14 = Begin
                        0x01000100000002000000000000000100000000000000f9eded00000000000000 ,
                        0x00000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =420
                            Top =8640
                            Width =1200
                            Height =238
                            FontSize =10
                            BorderColor =10319446
                            Name ="lblDPLDate"
                            Caption ="*DPL Date"
                            GridlineColor =10921638
                            LayoutCachedLeft =420
                            LayoutCachedTop =8640
                            LayoutCachedWidth =1620
                            LayoutCachedHeight =8878
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =0
                    OverlapFlags =255
                    Left =240
                    Top =8040
                    Width =15420
                    Height =1200
                    BorderColor =2500134
                    Name ="Box207"
                    GridlineColor =10921638
                    LayoutCachedLeft =240
                    LayoutCachedTop =8040
                    LayoutCachedWidth =15660
                    LayoutCachedHeight =9240
                    BorderThemeColorIndex =0
                    BorderTint =85.0
                    BorderShade =100.0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =247
                    TextAlign =2
                    Left =420
                    Top =7860
                    Width =2340
                    Height =300
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =8355711
                    ForeColor =16777215
                    Name ="Label203"
                    Caption ="Data Processing Level"
                    GridlineColor =10921638
                    LayoutCachedLeft =420
                    LayoutCachedTop =7860
                    LayoutCachedWidth =2760
                    LayoutCachedHeight =8160
                    BackThemeColorIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =240
                    Top =7020
                    Width =15420
                    Height =723
                    TabIndex =6
                    BorderColor =14211288
                    ForeColor =4210752
                    Name ="Notes"
                    ControlSource ="Notes"
                    GridlineColor =10921638

                    LayoutCachedLeft =240
                    LayoutCachedTop =7020
                    LayoutCachedWidth =15660
                    LayoutCachedHeight =7743
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =240
                            Top =6840
                            Width =2160
                            Height =240
                            FontSize =8
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="lblNotes"
                            Caption ="Riparian Vegetation Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =240
                            LayoutCachedTop =6840
                            LayoutCachedWidth =2400
                            LayoutCachedHeight =7080
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Top =1020
                    Width =15840
                    Name ="Line9"
                    GridlineColor =10921638
                    LayoutCachedTop =1020
                    LayoutCachedWidth =15840
                    LayoutCachedHeight =1020
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =12720
                    Top =240
                    Width =240
                    Height =315
                    TabIndex =7
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="ID"
                    ControlSource ="ID"
                    GridlineColor =10921638

                    LayoutCachedLeft =12720
                    LayoutCachedTop =240
                    LayoutCachedWidth =12960
                    LayoutCachedHeight =555
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const mstrcFormName As String = "sfrm_RiparianVegetationActivity"

Private Sub Form_Load()
On Error GoTo Error_Handler

    'Check for an existing Activity record and disable Riparian Veg Observations form if there isn't a record or there is a
    'record but nothing was observed. If there is an existing Activity record that states observations were made, enable
    'Observations forms.
    
    Dim ActivityExists As Boolean
    Dim YesLookupID As Integer

    ActivityExists = CheckRecExists(Me.RecordsetClone, "VisitID = " & Me.VisitID)
    YesLookupID = LookupIDFromCode("lookup_isVegetationObserved", "Y")

    If ActivityExists = True And Me.cboIsVegetationObserved = YesLookupID And Not IsNull(Me.MistletoePresentID) Then
        Me.sfrmRiparianVegetationObservation.Enabled = True
    Else
        Me.sfrmRiparianVegetationObservation.Enabled = False
    End If

Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_Load" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub cboIsVegetationObserved_AfterUpdate()
On Error GoTo Error_Handler
    
    'If user selects "yes" there were invasives observed, enable invasives observation form.
    'If user selects "no" to indicate no invasives were observed, don't change choice and don't disable form if there
    'are observations records.
    '3/22/2018 MEL converted to use combo box instead of option group

    Dim ObservationExists As Boolean
    Dim YesLookupID As Integer
    
    ObservationExists = CheckRecExists(Me.sfrmRiparianVegetationObservation.Form.RecordsetClone, "RiparianVegetationActivityID = " & Me.ID)
    YesLookupID = LookupIDFromCode("lookup_IsVegetationObserved", "Y")

    If Me.cboIsVegetationObserved = YesLookupID Then
        Me.sfrmRiparianVegetationObservation.Enabled = True
    ElseIf ObservationExists Then
        MsgBox ("One or more Invasive Species Observations have been entered for this visit. " & Chr(13) + vbNewLine & _
        "If you are sure you want to change ""Riparian Vegetation Observed?"" to ""No"", please delete your Vegetation Observations first."), vbOKOnly + vbExclamation, "Existing Records"
        Me.cboIsVegetationObserved = YesLookupID
        Me.sfrmRiparianVegetationObservation.Enabled = True
    Else
        Me.sfrmRiparianVegetationObservation.Enabled = False
    End If
    
    DoCmd.Save acDefault
    Forms!frm_Visit!sfrmActivityDashboard.Form.Requery

Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboInvasivesObserved_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)

    'Requery the DPL date text box to force the date to show
    Me.txtdataprocessingleveldate.Requery

End Sub

Private Sub cboDataProcessingLevelID_AfterUpdate()
On Error GoTo Error_Handler

    'Call function to validate DPL changes; update intro tab dashboard when required
    'MEL - Version 2018-03-30a
    
    If fxnDPLUpdate(Me) = True Then
        DoCmd.RunCommand acCmdSaveRecord
        Forms!frm_Visit!sfrmActivityDashboard.Form.Requery
    Else
        Me.Undo
    End If
        
Exit_Sub:
    Exit Sub
Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboDataProcessingLevelID_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
End Sub


'Private Sub Form_Load()
'On Error GoTo Error_Handler
'
'    Dim RiparianVegetationObservationExists
'
'    RiparianVegetationObservationExists = checkRecExists(Me.sfrmRiparianVegetationObservation.Form.Recordset, "RiparianVegetationActivityID = " & Me.VisitID)
'
'    'If something is selected for IsVegetationObserved, and IsMistletoePresent, enable Riparian Vegetation Observations form
'    'Enable Riparian Vegetation Photos form when observation records are present
'    If Not IsNull(Me.IsVegetationObservedID And Me.MistletoePresentID) Then
'        Me.sfrmRiparianVegetationObservation.Enabled = True
'        If RiparianVegetationObservationExists Then
'            Me.sfrmRiparianVegetationObservation.Form.sfrmRiparianVegetationPhoto.Enabled = True
'        Else
'            Me.sfrmRiparianVegetationObservation.Form.sfrmRiparianVegetationPhoto.Enabled = False
'        End If
'    Else
'        Me.sfrmRiparianVegetationObservation.Enabled = False
'    End If
'
'Exit_Sub:
'    Exit Sub
'Error_Handler:
'    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  Form_Load" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
'    Resume Exit_Sub
'End Sub
'
'Private Sub cboIsVegetationObserved_AfterUpdate()
'On Error GoTo Error_Handler
'
'    'Enable Riparian Vegetation Observation form when something is selected for vegetation observed and mistletoe present
'    If Not IsNull(Me.IsVegetationObservedID And Me.MistletoePresentID) Then
'        Me.sfrmRiparianVegetationObservation.Enabled = True
'    Else
'        Me.sfrmRiparianVegetationObservation.Enabled = False
'    End If
'
'Exit_Sub:
'    Exit Sub
'Error_Handler:
'    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboIsVegetationObserved_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
'    Resume Exit_Sub
'End Sub
'
'Private Sub cboIsMistletoePresent_AfterUpdate()
'On Error GoTo Error_Handler
'
'    'Enable Riparian Vegetation Observation form when something is selected for vegetation observed and mistletoe present
'    If Not IsNull(Me.IsVegetationObservedID And Me.MistletoePresentID) Then
'        Me.sfrmRiparianVegetationObservation.Enabled = True
'    Else
'        Me.sfrmRiparianVegetationObservation.Enabled = False
'    End If
'
'Exit_Sub:
'    Exit Sub
'Error_Handler:
'    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  cboIsMistletoePresent_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
'    Resume Exit_Sub
'End Sub
