Version =20
VersionRequired =20
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    NavigationButtons = NotDefault
    CloseButton = NotDefault
    DividingLines = NotDefault
    KeyPreview = NotDefault
    ScrollBars =2
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =15840
    DatasheetFontHeight =11
    ItemSuffix =27
    Left =1395
    Top =5025
    Right =16980
    Bottom =10410
    DatasheetGridlinesColor =14806254
    AfterInsert ="[Event Procedure]"
    RecSrcDt = Begin
        0x033976c5b515e540
    End
    RecordSource ="data_SensorRetrievalAttempt"
    OnCurrent ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnKeyUp ="[Event Procedure]"
    Moveable =0
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin Chart
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Tab
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =3
            BackThemeColorIndex =1
            BackShade =85.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =2
            BorderTint =60.0
            HoverThemeColorIndex =1
            PressedThemeColorIndex =1
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
            ForeThemeColorIndex =0
            ForeTint =75.0
        End
        Begin Page
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =435
            BackColor =15921906
            Name ="FormHeader"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =36
                    Width =2910
                    Height =299
                    FontWeight =700
                    BackColor =4281912
                    BorderColor =6108695
                    ForeColor =16777215
                    Name ="lblTitle"
                    Caption ="Sensor Retrieval Attempts"
                    GridlineColor =10921638
                    LayoutCachedLeft =36
                    LayoutCachedWidth =2946
                    LayoutCachedHeight =299
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin Line
                    BorderWidth =1
                    OverlapFlags =85
                    Top =420
                    Width =15840
                    Name ="Line24"
                    GridlineColor =10921638
                    LayoutCachedTop =420
                    LayoutCachedWidth =15840
                    LayoutCachedHeight =420
                End
            End
        End
        Begin Section
            Height =1395
            BackColor =15921906
            Name ="Detail"
            AlternateBackColor =15527148
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2398
                    Top =840
                    Width =2638
                    Height =297
                    TabIndex =2
                    BorderColor =14211288
                    Name ="txtRetrievalTimeOfDay"
                    ControlSource ="RetrievalTimeOfDay"
                    Format ="Short Time"
                    GridlineColor =10921638
                    ShowDatePicker =0

                    LayoutCachedLeft =2398
                    LayoutCachedTop =840
                    LayoutCachedWidth =5036
                    LayoutCachedHeight =1137
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =300
                            Top =840
                            Width =2034
                            Height =300
                            FontSize =10
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            BorderColor =6108695
                            Name ="Label2"
                            Caption ="  Retrieval Time (24hr)"
                            GridlineColor =10921638
                            LayoutCachedLeft =300
                            LayoutCachedTop =840
                            LayoutCachedWidth =2334
                            LayoutCachedHeight =1140
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =2398
                    Top =120
                    Width =2638
                    Height =297
                    BorderColor =14211288
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"20\""
                    Name ="cboIsSensorRetrieved"
                    ControlSource ="IsSensorRetrievedID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_IsSensorRetrieved.ID, lookup_IsSensorRetrieved.Label FROM lookup_I"
                        "sSensorRetrieved ORDER BY lookup_IsSensorRetrieved.Label; "
                    ColumnWidths ="0;1440"
                    AfterUpdate ="[Event Procedure]"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =2398
                    LayoutCachedTop =120
                    LayoutCachedWidth =5036
                    LayoutCachedHeight =417
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =60
                            Top =120
                            Width =2280
                            Height =297
                            FontSize =10
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            BorderColor =6108695
                            Name ="Label0"
                            Caption ="*Retrieved?"
                            GridlineColor =10921638
                            LayoutCachedLeft =60
                            LayoutCachedTop =120
                            LayoutCachedWidth =2340
                            LayoutCachedHeight =417
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =10320
                    Top =120
                    Width =4926
                    Height =1140
                    FontSize =10
                    TabIndex =5
                    BorderColor =14211288
                    Name ="txtNotes"
                    ControlSource ="Notes"
                    GridlineColor =10921638

                    LayoutCachedLeft =10320
                    LayoutCachedTop =120
                    LayoutCachedWidth =15246
                    LayoutCachedHeight =1260
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ThemeFontIndex =-1
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =9660
                            Top =120
                            Width =600
                            Height =311
                            FontSize =10
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            BorderColor =6108695
                            Name ="Label4"
                            Caption ="  Notes"
                            GridlineColor =10921638
                            LayoutCachedLeft =9660
                            LayoutCachedTop =120
                            LayoutCachedWidth =10260
                            LayoutCachedHeight =431
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1440
                    Left =7140
                    Top =120
                    Width =2460
                    Height =297
                    TabIndex =3
                    BorderColor =14211288
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"50\""
                    Name ="cboSensorProblemID"
                    ControlSource ="SensorProblemID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_SensorProblem.ID, lookup_SensorProblem.Label FROM lookup_SensorPro"
                        "blem ORDER BY lookup_SensorProblem.Label; "
                    ColumnWidths ="0;1440"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =7140
                    LayoutCachedTop =120
                    LayoutCachedWidth =9600
                    LayoutCachedHeight =417
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =5100
                            Top =120
                            Width =1980
                            Height =297
                            FontSize =10
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            BorderColor =6108695
                            Name ="Label1"
                            Caption ="*Sensor Problem"
                            GridlineColor =10921638
                            LayoutCachedLeft =5100
                            LayoutCachedTop =120
                            LayoutCachedWidth =7080
                            LayoutCachedHeight =417
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =3456
                    Left =7140
                    Top =480
                    Width =2460
                    Height =297
                    TabIndex =4
                    BorderColor =14211288
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"100\""
                    Name ="cboIsDownloadSuccessfulID"
                    ControlSource ="IsDownloadSuccessfulID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT lookup_IsDownloadSuccessful.ID, lookup_IsDownloadSuccessful.Code, lookup_"
                        "IsDownloadSuccessful.Label FROM lookup_IsDownloadSuccessful ORDER BY lookup_IsDo"
                        "wnloadSuccessful.Code; "
                    ColumnWidths ="0;0;3456"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =7140
                    LayoutCachedTop =480
                    LayoutCachedWidth =9600
                    LayoutCachedHeight =777
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =5100
                            Top =480
                            Width =1980
                            Height =297
                            FontSize =10
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            BorderColor =6108695
                            Name ="Label3"
                            Caption ="  Download Successful?"
                            GridlineColor =10921638
                            LayoutCachedLeft =5100
                            LayoutCachedTop =480
                            LayoutCachedWidth =7080
                            LayoutCachedHeight =777
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2399
                    Top =480
                    Width =2638
                    Height =297
                    TabIndex =1
                    BorderColor =14211288
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"0\""
                    Name ="cboSensorDeploymentID"
                    ControlSource ="SensorDeploymentID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT data_SensorDeployment.ID, [ref_Sensor].[Label] & \", deployed \" & [data_"
                        "Visit].[VisitDate] AS cboText, data_SensorDeployment.SensorID, data_Site.ID, dat"
                        "a_SensorRetrievalAttempt.ID FROM (((data_Site INNER JOIN data_Visit ON data_Site"
                        ".ID = data_Visit.SiteID) INNER JOIN data_SensorDeployment ON data_Visit.ID = dat"
                        "a_SensorDeployment.VisitID) INNER JOIN ref_Sensor ON data_SensorDeployment.Senso"
                        "rID = ref_Sensor.ID) LEFT JOIN data_SensorRetrievalAttempt ON data_SensorDeploym"
                        "ent.ID = data_SensorRetrievalAttempt.SensorDeploymentID WHERE (((data_SensorDepl"
                        "oyment.SensorID)<>Forms!frm_Visit!sfrm_SensorDeployment.Form!SensorID) And ((dat"
                        "a_Site.ID)=Forms!frm_Visit!SiteID) And ((data_SensorRetrievalAttempt.ID) Is Null"
                        " Or (data_SensorRetrievalAttempt.ID)=Forms!frm_Visit!sfrm_SensorRetrievalAttempt"
                        ".Form!ID)); "
                    ColumnWidths ="0;2880"
                    GridlineColor =10921638
                    AllowValueListEdits =0
                    InheritValueList =0

                    ShowOnlyRowSourceValues =255
                    LayoutCachedLeft =2399
                    LayoutCachedTop =480
                    LayoutCachedWidth =5037
                    LayoutCachedHeight =777
                    ThemeFontIndex =-1
                    BackThemeColorIndex =-1
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    ForeThemeColorIndex =-1
                    ForeShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =60
                            Top =480
                            Width =2280
                            Height =300
                            FontSize =10
                            LeftMargin =22
                            TopMargin =22
                            RightMargin =22
                            BottomMargin =22
                            BorderColor =6108695
                            Name ="Label8"
                            Caption ="*Prior Sensor Deployment"
                            GridlineColor =10921638
                            LayoutCachedLeft =60
                            LayoutCachedTop =480
                            LayoutCachedWidth =2340
                            LayoutCachedHeight =780
                            ThemeFontIndex =-1
                            BorderThemeColorIndex =-1
                            BorderTint =100.0
                            ForeThemeColorIndex =-1
                            ForeTint =100.0
                        End
                    End
                End
                Begin Line
                    BorderWidth =1
                    OverlapFlags =85
                    Top =1380
                    Width =15840
                    Name ="Line14"
                    GridlineColor =10921638
                    LayoutCachedTop =1380
                    LayoutCachedWidth =15840
                    LayoutCachedHeight =1380
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    PictureType =2
                    Left =15300
                    Top =120
                    Width =486
                    Height =1140
                    TabIndex =6
                    ForeColor =4210752
                    Name ="cmdDeleteSensorRetrieval"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Delete Record"
                    Picture ="X-Mark-16-LtGray"
                    GridlineColor =10921638

                    LayoutCachedLeft =15300
                    LayoutCachedTop =120
                    LayoutCachedWidth =15786
                    LayoutCachedHeight =1260
                    Gradient =0
                    BackColor =15527148
                    BackThemeColorIndex =-1
                    BackTint =100.0
                    BorderColor =12566463
                    BorderThemeColorIndex =-1
                    BorderTint =100.0
                    HoverColor =1643706
                    HoverThemeColorIndex =-1
                    HoverTint =100.0
                    PressedColor =15527148
                    PressedThemeColorIndex =-1
                    PressedShade =100.0
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =12428174
            Name ="FormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Const mstrcFormName As String = "sfrm_SensorRetrievalAttempt"
Private YesID As Integer

Private Sub cboIsSensorRetrieved_AfterUpdate()

On Error GoTo Error_Handler

'If sensor not retrieved, set download successful to N/A
    If Me.IsSensorRetrievedID = 2 Then
        Me.cboIsDownloadSuccessfulID = 8
'If no sensor retrieval data, set download successful to No Data
    ElseIf Me.IsSensorRetrievedID = 9 Then
        Me.cboIsDownloadSuccessfulID = 9
'If sensor retrieved and download successful is set to N/A, set download successful to null.
    ElseIf Me.IsSensorRetrievedID = 1 And Me.IsDownloadSuccessfulID = 8 Then
        Me.cboIsDownloadSuccessfulID = Null
    End If
    
Exit_Sub:
    Exit Sub

Error_Handler:
    MsgBox "Form: " & mstrcFormName & vbNewLine & "Sub:  form_AfterUpdate" & vbNewLine & "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Sub
    
End Sub

Private Sub cmdDeleteSensorRetrieval_Click()
    
'Delete Sensor Retrieval record from data_SensorRetrievalAttempt

    On Error Resume Next
    
    DeleteRecord Me, Me.NewRecord
    
End Sub

Private Sub cmdDeleteTSensorDataHumidity_Click()

'Delete Sensor Humidity Import records from data_SensorImportHeader_Humidity/data_SensorImportDetail_Humidity

    On Error Resume Next
        
    Dim RetrievalID As String
    Dim ImportType As String
    Dim YesNo As Integer
    Dim SensorHumidityImportDataExists As Boolean
    
    SensorHumidityImportDataExists = Nz(DLookup("ID", "data_SensorImportHeader_Humidity", "SensorRetrievalAttemptID = " & Me.ID))

    If IsNull(Me.ID) Then
        Resume Next
    Else
        If Not IsNull(Me.ID) And SensorHumidityImportDataExists = False Then
            Resume Next
        Else
            If SensorHumidityImportDataExists = True Then
                YesNo = MsgBox("You are about to delete the Sensor Humidity Import Data for this visit." & Chr(13) & vbNewLine & "If you click Yes, you won't be able to undo this Delete operation." & Chr(13) _
                & "Are you sure you want to delete all the Sensor Humidity Import Data?", vbYesNo + vbExclamation, "Delete Imported Sensor Humidity Data?")
                If YesNo = vbYes Then
                    CurrentDb.Execute "Delete * from data_SensorImportHeader_Humidity where SensorRetrievalAttemptID = " & Me.ID, dbSeeChanges
                    Me.Requery
                Else
                    Me.Undo
                End If
            End If
        End If
    End If

End Sub

Private Sub cmdDeleteTSensorDataTemperature_Click()

'Delete Sensor Temperature Import records from data_SensorImportHeader_Temperature/data_SensorImportDetail_Temperature

    On Error Resume Next
        
    Dim RetrievalID As String
    Dim ImportType As String
    Dim YesNo As Integer
    Dim SensorTemperatureImportDataExists As Boolean
    
    SensorTemperatureImportDataExists = Nz(DLookup("ID", "data_SensorImportHeader_Temperature", "SensorRetrievalAttemptID = " & Me.ID))

    If IsNull(Me.ID) Then
        Resume Next
    Else
        If Not IsNull(Me.ID) And SensorTemperatureImportDataExists = False Then
            Resume Next
        Else
            If SensorTemperatureImportDataExists = True Then
            YesNo = MsgBox("You are about to delete the Sensor Temperature Import Data for this visit." & Chr(13) & vbNewLine & "If you click Yes, you won't be able to undo this Delete operation." & Chr(13) _
            & "Are you sure you want to delete all the Sensor Temperature Import Data?", vbYesNo + vbExclamation, "Delete Imported Sensor Temperature Data?")
                If YesNo = vbYes Then
                    CurrentDb.Execute "Delete * from data_SensorImportHeader_Temperature where SensorRetrievalAttemptID = " & Me.ID, dbSeeChanges
                    Me.Requery
                Else
                    Me.Undo
                End If
            End If
        End If
    End If

End Sub





Private Sub Form_BeforeUpdate(Cancel As Integer)
'LC 10/30/2017 - Before adding record to table, check for nulls in required fields

    If IsNull(Me.cboIsSensorRetrieved) Or _
        IsNull(Me.cboSensorDeploymentID) Or _
        IsNull(Me.cboSensorProblemID) Then
        MsgBox ("Please complete all required (*) fields for the sensor retrieval record. Or hit the 'Esc' key if there is no sensor retrieval information to record."), vbOKOnly + vbExclamation, "Sensor Retrieval"
        Cancel = True
        Me.cboIsSensorRetrieved.SetFocus
    End If
            
End Sub

Private Function cmdImportTSensorDataTemperature_CanExecute() As Boolean
    If Not IsNull(Me.ID) Then
        cmdImportTSensorDataTemperature_CanExecute = (Me.IsSensorRetrievedID = YesID)
    Else
        cmdImportTSensorDataTemperature_CanExecute = False
    End If
End Function
Private Function cmdDeleteTSensorDataTemperature_CanExecute() As Boolean
    If Not IsNull(Me.ID) Then
        cmdDeleteTSensorDataTemperature_CanExecute = (Me.IsSensorRetrievedID = YesID)
    Else
        cmdDeleteTSensorDataTemperature_CanExecute = False
    End If
End Function

Private Function cmdImportTSensorDataHumidity_CanExecute() As Boolean
    If Not IsNull(Me.ID) Then
        cmdImportTSensorDataHumidity_CanExecute = (Me.IsSensorRetrievedID = YesID)
    Else
        cmdImportTSensorDataHumidity_CanExecute = False
    End If
End Function
Private Function cmdDeleteTSensorDataHumidity_CanExecute() As Boolean
    If Not IsNull(Me.ID) Then
        cmdDeleteTSensorDataHumidity_CanExecute = (Me.IsSensorRetrievedID = YesID)
    Else
        cmdDeleteTSensorDataHumidity_CanExecute = False
    End If
End Function

Private Sub Form_Open(Cancel As Integer)
    YesID = DLookup("ID", "lookup_IsSensorRetrieved", "Label = 'Yes'")
End Sub
